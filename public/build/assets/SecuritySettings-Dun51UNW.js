import{r as a,j as t}from"./app-_tcWvRHw.js";import Ee from"./SettingsSectionShell-BcY7WPRA.js";import{F as Ae}from"./ShieldCheckIcon-CA2OQXfN.js";import{F as Re}from"./ArrowPathIcon-CuaHF-ku.js";import{F as Fe}from"./TrashIcon-D-uWvGqQ.js";function Me({title:r,titleId:d,...x},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":d},x),r?a.createElement("title",{id:d},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const oe=a.forwardRef(Me);function _e({title:r,titleId:d,...x},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":d},x),r?a.createElement("title",{id:d},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"}))}const Te=a.forwardRef(_e);function De({title:r,titleId:d,...x},n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":d},x),r?a.createElement("title",{id:d},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"}))}const Ie=a.forwardRef(De);function We(){const[r,d]=a.useState("main"),[x,n]=a.useState(!1),[B,i]=a.useState(""),[F,ce]=a.useState([]),[k,u]=a.useState(null),[H,de]=a.useState({top:0,left:0}),[C,L]=a.useState(!1),[p,K]=a.useState("sessions"),[c,E]=a.useState(null),[Z,f]=a.useState([]),[z,b]=a.useState([]),[g,M]=a.useState(120),[xe,y]=a.useState(!1),[J,v]=a.useState(null),[_,j]=a.useState("clear_all"),[me,w]=a.useState(null),[A,G]=a.useState(!1),[V,Q]=a.useState({l1:!0,l2:!0,l3:!0,l4:!0,l5:!0,l6:!0,l7:!0}),[T,D]=a.useState({enabled:!1,message:""}),[h,Y]=a.useState(!1),[I,O]=a.useState([]),[ee,U]=a.useState(0),[N,te]=a.useState(!0),[X,ue]=a.useState(!0),se=a.useRef(null),q="security_live_logs_cursor",ae="security_live_logs_running",he=a.useMemo(()=>[{key:"main",label:"Main"},{key:"activities",label:"Activities"},{key:"live_logs",label:"Live Logs"}],[]),pe=e=>"inline-flex items-center border-b-2 px-4 py-3 text-[12px] font-semibold transition "+(e?"border-slate-900 text-slate-900":"border-transparent text-slate-500 hover:text-slate-900"),fe=({active:e})=>t.jsx("span",{className:"inline-flex h-2.5 w-2.5 rounded-full "+(e?"bg-emerald-500":"bg-red-500")}),be=()=>{if(!xe)return null;const e=_==="delete_one"?"Deactivate Session":"Clear Session",s=_==="delete_one"?"This will deactivate this session token and log out that device.":"This will log out this user on all devices.";return t.jsxs("div",{className:"fixed inset-0 z-[80] flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>{y(!1),v(null),j("clear_all"),w(null)}}),t.jsxs("div",{className:"relative w-full max-w-md rounded-2xl border border-slate-200 bg-white p-5 shadow-2xl",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:e}),t.jsxs("div",{className:"mt-2 text-[12px] text-slate-600",children:[s," ",t.jsx("span",{className:"font-semibold text-slate-900",children:J?.name})]}),t.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>{y(!1),v(null),j("clear_all"),w(null)},className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Cancel"}),t.jsx("button",{type:"button",onClick:()=>{const l=J,o=me,S=_;if(y(!1),v(null),j("clear_all"),w(null),!!l){if(S==="delete_one"&&o){we(l,o);return}S==="clear_all"&&Ne(l)}},className:"rounded-xl bg-red-600 px-4 py-2 text-[12px] font-semibold text-white hover:bg-red-500",children:"Confirm"})]})]})]})};a.useEffect(()=>{const e=s=>{s.target?.closest?.("[data-security-menu]")||u(null)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);const ge=e=>{try{const l=`; ${document.cookie}`.split(`; ${e}=`);return l.length===2?l.pop().split(";").shift():""}catch{return""}},P=()=>{const e=ge("XSRF-TOKEN");return e?decodeURIComponent(e):""},m=async e=>{const s=await e.text();try{return s?JSON.parse(s):{}}catch{return{}}},ye=()=>{i(""),G(!1),fetch(route("admin.security.main"),{credentials:"same-origin"}).then(async e=>{const s=await m(e);if(!e.ok)throw new Error(s?.message||"Failed");s?.pyramid&&Q({l1:!!s.pyramid.l1,l2:!!s.pyramid.l2,l3:!!s.pyramid.l3,l4:!!s.pyramid.l4,l5:!!s.pyramid.l5,l6:!!s.pyramid.l6,l7:!!s.pyramid.l7}),s?.maintenance&&D({enabled:!!s.maintenance.enabled,message:s.maintenance.message||""})}).catch(e=>i(e?.message||"Failed to load security settings")).finally(()=>G(!0))},ve=()=>{Y(!0),i(""),fetch(route("admin.security.main.update"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"","X-XSRF-TOKEN":P(),Accept:"application/json"},body:JSON.stringify({pyramid:V,maintenance:T})}).then(async e=>{const s=await m(e);if(!e.ok)throw new Error(s?.message||"Failed to save")}).catch(e=>i(e?.message||"Failed to save")).finally(()=>Y(!1))},R=()=>{n(!0),i(""),fetch(route("admin.security.users"),{credentials:"same-origin"}).then(async e=>{const s=await m(e);if(!e.ok)throw new Error(s?.message||"Failed");ce(Array.isArray(s?.users)?s.users:[])}).catch(e=>i(e?.message||"Failed to load users")).finally(()=>n(!1))};a.useEffect(()=>{r==="main"&&(A||ye())},[r]),a.useEffect(()=>{r==="activities"&&R()},[r]);const le=e=>{K("sessions"),E(e),L(!0),f([]),b([]),M(120),n(!0),i(""),W(e)},W=e=>{fetch(route("admin.security.users.sessions",e.id),{credentials:"same-origin"}).then(async s=>{const l=await m(s);if(!s.ok)throw new Error(l?.message||"Failed");f(Array.isArray(l?.sessions)?l.sessions:[])}).catch(s=>i(s?.message||"Failed to load sessions")).finally(()=>n(!1))},re=e=>{v(e),j("clear_all"),w(null),y(!0)},je=(e,s)=>{v(e),j("delete_one"),w(s),y(!0)},we=(e,s)=>{n(!0),i(""),fetch(route("admin.security.users.sessions.delete",{user:e.id,sessionId:s}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"","X-XSRF-TOKEN":P(),Accept:"application/json"}}).then(async l=>{const o=await m(l);if(!l.ok)throw new Error(o?.message||"Failed");W(e),R()}).catch(l=>i(l?.message||"Failed to delete session")).finally(()=>n(!1))},Ne=e=>{n(!0),i(""),fetch(route("admin.security.users.sessions.clear",e.id),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"","X-XSRF-TOKEN":P(),Accept:"application/json"}}).then(async s=>{const l=await m(s);if(!s.ok)throw new Error(l?.message||"Failed");R(),C&&c?.id===e.id&&le(e)}).catch(s=>i(s?.message||"Failed to clear sessions")).finally(()=>n(!1))},Se=(e,s)=>{if(!s){u(k===e.id?null:e.id);return}const l=s.getBoundingClientRect(),o=208,S=Math.max(12,Math.min(window.innerWidth-o-12,l.right-o)),Le=l.bottom+8;de({top:Le,left:S}),u(k===e.id?null:e.id)},ke=e=>{K("logs"),E(e),L(!0),f([]),b([]),M(120),n(!0),i(""),$(e,120)},$=(e,s)=>{fetch(route("admin.security.users.logs",e.id)+`?limit=${encodeURIComponent(s)}`,{credentials:"same-origin"}).then(async l=>{const o=await m(l);if(!l.ok)throw new Error(o?.message||"Failed");b(Array.isArray(o?.logs)?o.logs:[])}).catch(l=>i(l?.message||"Failed to load logs")).finally(()=>n(!1))};a.useEffect(()=>{if(!C||!c?.id)return;const e=c,s=setInterval(()=>{p==="sessions"&&(n(!0),W(e)),p==="logs"&&(n(!0),$(e,g))},1500);return()=>clearInterval(s)},[C,p,c?.id,g]);const ne=({checked:e,onChange:s,disabled:l})=>t.jsx("button",{type:"button",onClick:()=>!l&&s(!e),className:"relative inline-flex h-6 w-11 items-center rounded-full transition "+(e?"bg-slate-900":"bg-slate-200")+(l?" opacity-60":""),"aria-pressed":e,children:t.jsx("span",{className:"inline-block h-5 w-5 transform rounded-full bg-white transition "+(e?"translate-x-5":"translate-x-1")})}),ie=()=>{fetch(route("admin.security.logs.tail",{cursor:ee,lines:400}),{credentials:"same-origin"}).then(e=>e.json()).then(e=>{const s=Array.isArray(e?.lines)?e.lines:[],l=Number(e?.cursor??0);U(l);try{localStorage.setItem(q,String(l))}catch{}s.length&&O(o=>o.concat(s).slice(-3e3))}).catch(()=>{})};a.useEffect(()=>{if(r!=="live_logs")return;O([]);let e=0,s=!0;try{e=Number(localStorage.getItem(q)||0),s=localStorage.getItem(ae)!=="0"}catch{e=0,s=!0}U(Number.isFinite(e)?e:0),te(!!s),ie()},[r]),a.useEffect(()=>{if(r!=="live_logs"||!N)return;const e=setInterval(()=>ie(),1200);return()=>clearInterval(e)},[r,N,ee]),a.useEffect(()=>{try{localStorage.setItem(ae,N?"1":"0")}catch{}},[N]),a.useEffect(()=>{if(r!=="live_logs"||!X)return;const e=se.current;e&&(e.scrollTop=e.scrollHeight)},[I,r,X]);const Ce=()=>C?t.jsxs("div",{className:"fixed inset-0 z-50",children:[t.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:()=>{L(!1),E(null),f([]),b([])}}),t.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-3xl bg-white shadow-2xl",children:[t.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-5 py-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:p==="sessions"?"User Sessions":"User Logs"}),t.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:c?.name||""})]}),t.jsx("button",{type:"button",onClick:()=>{L(!1),E(null),f([]),b([])},className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Close"})]}),t.jsx("div",{className:"p-5",children:p==="sessions"?t.jsxs("div",{className:"grid gap-3",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Sessions"}),t.jsx("button",{type:"button",onClick:()=>c&&re(c),className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-red-700 hover:bg-red-50",children:"Clear All"})]}),Z.length?Z.map(e=>t.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:e.ip_address||"Unknown IP"}),t.jsx("span",{className:"rounded-full px-2.5 py-1 text-[10px] font-semibold "+(e.last_activity&&Date.now()-new Date(e.last_activity).getTime()<=900*1e3?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-700"),children:e.last_activity&&Date.now()-new Date(e.last_activity).getTime()<=900*1e3?"Active":"Old"})]}),t.jsxs("div",{className:"mt-2 flex flex-wrap items-center justify-between gap-2",children:[t.jsxs("div",{className:"text-[11px] font-semibold text-slate-700 break-all",children:["Token: ",e.id]}),t.jsx("button",{type:"button",onClick:()=>c&&je(c,e.id),className:"rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-semibold text-red-700 hover:bg-red-50",children:"Deactivate"})]}),t.jsx("div",{className:"mt-1 text-[11px] text-slate-500 break-words",children:e.user_agent||""}),t.jsx("div",{className:"mt-2 text-[11px] text-slate-500",children:e.last_activity||""})]},e.id)):t.jsx("div",{className:"text-[12px] text-slate-500",children:"No sessions found."})]}):t.jsxs("div",{className:"grid gap-3",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Requests"}),t.jsx("button",{type:"button",onClick:()=>{const e=Math.min(300,g+60);M(e),c&&(n(!0),$(c,e))},disabled:g>=300,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold "+(g>=300?"text-slate-400":"text-slate-700 hover:bg-slate-50"),children:"Load more"})]}),z.length?z.slice().reverse().map((e,s)=>t.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[t.jsxs("div",{className:"inline-flex items-center gap-2",children:[t.jsx("span",{className:"rounded-md bg-slate-900 px-2 py-1 text-[10px] font-semibold text-white",children:e.method||"-"}),t.jsx("span",{className:"rounded-md px-2 py-1 text-[10px] font-semibold "+((Number(e.status)||0)>=400?"bg-red-50 text-red-700":"bg-emerald-50 text-emerald-700"),children:e.status||"-"}),t.jsx("span",{className:"text-[11px] text-slate-500",children:e.duration_ms?`${e.duration_ms}ms`:""})]}),t.jsx("div",{className:"text-[11px] text-slate-500",children:e.at||""})]}),t.jsx("div",{className:"mt-2 break-words text-[12px] font-semibold text-slate-900",children:e.path||"-"}),t.jsx("div",{className:"mt-1 text-[11px] text-slate-500 break-words",children:e.referer?`From: ${e.referer}`:""}),t.jsx("div",{className:"mt-1 text-[11px] text-slate-500",children:e.ip?`IP: ${e.ip}`:""})]},s)):t.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 text-[12px] text-slate-600",children:"No request logs yet. Browse the site using this user account, then refresh."})]})})]})]}):null;return t.jsx(Ee,{title:"",description:"",children:t.jsxs("div",{className:"-m-5 overflow-hidden rounded-2xl border border-slate-200 bg-white",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 px-6",children:[t.jsx("div",{className:"flex items-center",children:he.map(e=>t.jsx("button",{type:"button",onClick:()=>{i(""),d(e.key)},className:pe(r===e.key),children:e.label},e.key))}),t.jsx("div",{className:"my-3 text-[12px] text-slate-500",children:x?"Working…":""})]}),B?t.jsx("div",{className:"border-b border-slate-200 bg-red-50 px-6 py-3 text-[12px] text-red-700",children:B}):null,t.jsx("div",{className:"p-6",children:r==="main"?t.jsxs("div",{className:"grid gap-5",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2 text-[12px] font-semibold text-slate-900",children:[t.jsx(Ae,{className:"h-4 w-4"}),"FORTCO Security Pyramid"]}),t.jsx("button",{type:"button",onClick:ve,disabled:h,className:"rounded-xl px-4 py-2 text-[12px] font-semibold text-white "+(h?"bg-slate-400":"bg-slate-900 hover:bg-slate-800"),children:h?"Saving…":"Save"})]}),t.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white",children:[t.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Levels"}),t.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Enable or disable security layers."})]}),t.jsx("div",{className:"divide-y divide-slate-200",children:[{key:"l7",label:"L7 — Advanced Defense",meta:"SIEM, SOAR, XDR, ZTNA"},{key:"l6",label:"L6 — Privileged Access Management",meta:"PAM, JIT, Firefighter, Vault"},{key:"l5",label:"L5 — System Hardening & Audit",meta:"CIS Benchmarks, Immutable Logs"},{key:"l4",label:"L4 — Application Security",meta:"WAF, RASP, CSP, Anti-XSS/SQLi"},{key:"l3",label:"L3 — Identity & Access Governance",meta:"IAM, RBAC, ABAC, SoD, MFA"},{key:"l2",label:"L2 — Code & Dependency",meta:"SAST, DAST, SCA, Secure Coding"},{key:"l1",label:"L1 — Infrastructure Security",meta:"Network, Server, Encryption"}].map(e=>t.jsxs("div",{className:"flex items-center justify-between gap-4 px-5 py-4",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:e.label}),t.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:e.meta})]}),t.jsx(ne,{checked:!!V[e.key],onChange:s=>Q(l=>({...l,[e.key]:s})),disabled:!A||h})]},e.key))})]}),t.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4 border-b border-slate-200 px-5 py-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-[12px] font-semibold text-slate-900",children:[t.jsx(Ie,{className:"h-4 w-4"}),"Maintenance Mode"]}),t.jsx(ne,{checked:T.enabled,onChange:e=>D(s=>({...s,enabled:e})),disabled:!A||h})]}),t.jsxs("div",{className:"px-5 py-4",children:[t.jsx("label",{className:"block text-[12px] font-semibold text-slate-700",children:"Message"}),t.jsx("input",{value:T.message,onChange:e=>D(s=>({...s,message:e.target.value})),disabled:!A||h,className:"mt-2 w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-[12px] text-slate-900 outline-none ring-0 focus:border-slate-300",placeholder:"Optional message shown to users"}),t.jsx("div",{className:"mt-2 text-[12px] text-slate-500",children:"This setting is stored in database. You can later connect it to Laravel maintenance mode."})]})]})]}):r==="activities"?t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Users"}),t.jsxs("button",{type:"button",onClick:R,className:"inline-flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:[t.jsx(Re,{className:"h-4 w-4"}),"Refresh"]})]}),t.jsx("div",{className:"mt-4 rounded-xl border border-slate-200 bg-white",children:t.jsx("div",{className:"max-h-[560px] overflow-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50",children:t.jsxs("tr",{className:"text-left text-[12px] font-semibold text-slate-700",children:[t.jsx("th",{className:"px-4 py-3",children:"Status"}),t.jsx("th",{className:"px-4 py-3",children:"User"}),t.jsx("th",{className:"px-4 py-3",children:"Sessions"}),t.jsx("th",{className:"px-4 py-3",children:"Last Activity"}),t.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),t.jsx("tbody",{className:"divide-y divide-slate-200",children:F.length?F.map(e=>t.jsxs("tr",{className:"text-[12px] text-slate-700",children:[t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(fe,{active:!!e.active}),t.jsx("span",{className:"text-[12px] font-semibold text-slate-700",children:e.active?"Active":"Offline"})]})}),t.jsxs("td",{className:"px-4 py-3",children:[t.jsx("div",{className:"font-semibold text-slate-900",children:e.name}),t.jsx("div",{className:"text-slate-500",children:e.email})]}),t.jsx("td",{className:"px-4 py-3",children:e.sessions_count||0}),t.jsx("td",{className:"px-4 py-3 text-slate-500",children:e.last_activity||"-"}),t.jsx("td",{className:"px-4 py-3 text-right",children:t.jsx("div",{className:"inline-block","data-security-menu":!0,children:t.jsx("button",{type:"button",onClick:s=>Se(e,s.currentTarget),className:"inline-flex h-9 w-9 items-center justify-center rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50",children:t.jsx(Te,{className:"h-5 w-5"})})})})]},e.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-4 py-6 text-[12px] text-slate-500",children:"No users found."})})})]})})}),k?t.jsx("div",{"data-security-menu":!0,className:"fixed z-[60] w-52 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",style:{top:H.top,left:H.left},children:(()=>{const e=F.find(s=>s.id===k);return e?t.jsxs(t.Fragment,{children:[t.jsxs("button",{type:"button",onClick:()=>{u(null),le(e)},className:"flex w-full items-center gap-2 px-4 py-2 text-left text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:[t.jsx(oe,{className:"h-4 w-4"}),"Sessions"]}),t.jsxs("button",{type:"button",onClick:()=>{u(null),ke(e)},className:"flex w-full items-center gap-2 px-4 py-2 text-left text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:[t.jsx(oe,{className:"h-4 w-4"}),"Logs"]}),t.jsxs("button",{type:"button",onClick:()=>{u(null),re(e)},className:"flex w-full items-center gap-2 px-4 py-2 text-left text-[12px] font-semibold text-red-700 hover:bg-red-50",children:[t.jsx(Fe,{className:"h-4 w-4"}),"Clear Session"]})]}):null})()}):null,t.jsx(be,{}),t.jsx(Ce,{})]}):t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[t.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Live Logs"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:()=>{O([]),U(0);try{localStorage.setItem(q,"0")}catch{}},className:"inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Clear"}),t.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700",children:[t.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-primary-600 focus:ring-primary-500",checked:X,onChange:e=>ue(e.target.checked)}),"Auto-scroll"]}),t.jsx("button",{type:"button",onClick:()=>te(e=>!e),className:"inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:N?"Pause":"Resume"})]})]}),t.jsx("div",{ref:se,className:"mt-4 h-[520px] overflow-auto rounded-xl border border-slate-200 bg-black p-4 font-mono text-[11px] text-slate-100",children:I.length?I.map((e,s)=>t.jsx("div",{className:"whitespace-pre-wrap break-words",children:e},s)):t.jsx("div",{className:"text-slate-400",children:"Waiting for logs…"})})]})})]})})}export{We as default};
