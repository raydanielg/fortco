import{r as a,j as e,H as q}from"./app-_tcWvRHw.js";import{A as O}from"./AdminPanelLayout-0PjPupQC.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function z(){const[x,l]=a.useState(!1),[f,o]=a.useState(""),[N,k]=a.useState([]),[p,C]=a.useState([]),[j,S]=a.useState(""),[m,E]=a.useState(""),[A,d]=a.useState(!1),[_,h]=a.useState(!1),[u,y]=a.useState({name:"",description:""}),[g,w]=a.useState(!1),[i,r]=a.useState({id:null,title:"",content:"",category_id:"",is_published:!0}),c=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",b=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},n=()=>{l(!0),fetch(route("admin.knowledge-base.data",{q:j,category_id:m}),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await b(t);if(!t.ok)throw new Error(s?.message||"Failed to load");k(s.articles||[]),C(s.categories||[])}).catch(t=>o(t?.message)).finally(()=>l(!1))};a.useEffect(()=>{n()},[m]);const R=()=>{l(!0);const t=g?route("admin.knowledge-base.update",{article:i.id}):route("admin.knowledge-base.store");fetch(t,{method:g?"PUT":"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":c(),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then(async s=>{const v=await b(s);if(!s.ok)throw new Error(v?.message||"Failed to save");d(!1),r({id:null,title:"",content:"",category_id:"",is_published:!0}),n()}).catch(s=>o(s?.message)).finally(()=>l(!1))},F=()=>{l(!0),fetch(route("admin.knowledge-base.categories.store"),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":c(),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(u)}).then(async t=>{const s=await b(t);if(!t.ok)throw new Error(s?.message||"Failed to save category");y({name:"",description:""}),n()}).catch(t=>o(t?.message)).finally(()=>l(!1))},M=t=>{window.confirm("Delete this category? Articles will become uncategorized.")&&(l(!0),fetch(route("admin.knowledge-base.categories.destroy",{category:t}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":c(),Accept:"application/json"}}).then(async s=>{if(!s.ok)throw new Error("Failed to delete");n()}).catch(s=>o(s?.message)).finally(()=>l(!1)))},X=t=>{window.confirm("Delete this article?")&&(l(!0),fetch(route("admin.knowledge-base.destroy",{article:t}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":c(),Accept:"application/json"}}).then(async s=>{if(!s.ok)throw new Error("Failed to delete");n()}).catch(s=>o(s?.message)).finally(()=>l(!1)))},L=t=>{r({id:t.id,title:t.title,content:t.content,category_id:t.category_id||"",is_published:!!t.is_published}),w(!0),d(!0)},T=[{key:"tickets",label:"Tickets",href:route("admin.support.tickets")},{key:"live-chat",label:"Live Chat",href:route("admin.support.live-chat")},{key:"knowledge-base",label:"Knowledge Base",href:route("admin.support.knowledge-base")},{key:"helpdesk-messages",label:"Helpdesk Messages",href:route("admin.support.helpdesk-messages")}];return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Support - Knowledge Base"}),e.jsxs(O,{title:"Support",active:"knowledge-base",items:T,children:[e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Knowledge Base"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Manage articles and guides."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h(!0),className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Categories"}),e.jsx("button",{onClick:()=>{w(!1),r({id:null,title:"",content:"",category_id:"",is_published:!0}),d(!0)},className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800",children:"Add Article"})]})]}),e.jsxs("div",{className:"p-6",children:[f?e.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-[12px] text-red-700",children:f}):null,e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsx("input",{value:j,onChange:t=>S(t.target.value),onKeyDown:t=>t.key==="Enter"&&n(),placeholder:"Search articles...",className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] w-full max-w-sm"}),e.jsxs("select",{value:m,onChange:t=>E(t.target.value),className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"All Categories"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:N.map(t=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm hover:shadow-md transition text-left",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-400",children:t.category?.name||"Uncategorized"}),e.jsx("div",{className:`h-2 w-2 rounded-full ${t.is_published?"bg-emerald-500":"bg-slate-300"}`})]}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-slate-900 leading-snug",children:t.title}),e.jsx("p",{className:"mt-2 text-[12px] text-slate-500 line-clamp-3 leading-relaxed",children:t.content}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex items-center justify-between",children:[e.jsx("div",{className:"text-[10px] text-slate-400",children:new Date(t.created_at).toLocaleDateString()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>L(t),className:"text-[11px] font-semibold text-slate-700 hover:text-slate-900",children:"Edit"}),e.jsx("button",{onClick:()=>X(t.id),className:"text-[11px] font-semibold text-red-600 hover:text-red-700",children:"Delete"})]})]})]},t.id))})]}),A&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 p-4",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-2xl bg-white shadow-xl overflow-hidden text-left",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:g?"Edit Article":"New Article"}),e.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),e.jsxs("div",{className:"p-6 grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700 uppercase tracking-wide",children:"Title"}),e.jsx("input",{value:i.title,onChange:t=>r(s=>({...s,title:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px]",placeholder:"e.g. How to reset your password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700 uppercase tracking-wide",children:"Category"}),e.jsxs("select",{value:i.category_id,onChange:t=>r(s=>({...s,category_id:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select Category"}),p.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700 uppercase tracking-wide",children:"Content"}),e.jsx("textarea",{value:i.content,onChange:t=>r(s=>({...s,content:t.target.value})),rows:8,className:"mt-1 w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px]",placeholder:"Write article instructions here..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_pub",checked:i.is_published,onChange:t=>r(s=>({...s,is_published:t.target.checked}))}),e.jsx("label",{htmlFor:"is_pub",className:"text-[12px] text-slate-700",children:"Published"})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-[12px] font-semibold text-slate-700",children:"Cancel"}),e.jsx("button",{onClick:R,disabled:x||!i.title||!i.content,className:"rounded-xl bg-slate-900 px-6 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-50",children:x?"Saving...":"Save Article"})]})]})}),_&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-950/40 p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white shadow-xl overflow-hidden text-left",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Manage Categories"}),e.jsx("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-slate-600",children:"✕"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"grid gap-4 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700 uppercase tracking-wide",children:"Category Name"}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("input",{value:u.name,onChange:t=>y(s=>({...s,name:t.target.value})),className:"w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px]",placeholder:"e.g. Finance"}),e.jsx("button",{onClick:F,disabled:x||!u.name,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-50",children:"Add"})]})]})}),e.jsx("div",{className:"grid gap-2 max-h-60 overflow-auto",children:p.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 bg-slate-50",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("button",{onClick:()=>M(t.id),className:"text-red-600 hover:text-red-700 p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},t.id))})]}),e.jsx("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-200 flex justify-end",children:e.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-[12px] font-semibold text-slate-700",children:"Close"})})]})})]})]})}export{z as default};
