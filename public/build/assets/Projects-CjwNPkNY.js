import{r,j as e,H as X}from"./app-_tcWvRHw.js";import{A as B}from"./AdminPanelLayout-0PjPupQC.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function U(){const[o,d]=r.useState(!1),[y,n]=r.useState(""),[i,w]=r.useState([]),[h,k]=r.useState(""),[x,S]=r.useState("all"),[p,C]=r.useState("all"),[c,g]=r.useState({}),[_,u]=r.useState(!1),[l,a]=r.useState({type:"featured",name:"",slug:"",location:"",year:"",category:"",value:"",expected:"",progress:"",desc:"",features:"",occupied_by:"",status_updates:"",testimonial:"",sort_order:0,is_published:!0}),v=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",f=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},j=r.useMemo(()=>{const t=new URLSearchParams;h&&t.set("q",h),x&&x!=="all"&&t.set("type",x),p&&p!=="all"&&t.set("published",p);const s=t.toString();return s?`?${s}`:""},[h,x,p]),b=()=>{d(!0),n(""),fetch(route("admin.portfolio-projects.data")+j,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await f(t);if(!t.ok)throw new Error(s?.message||"Failed to load portfolio projects");w(Array.isArray(s?.projects)?s.projects:[])}).catch(t=>n(t?.message||"Failed to load portfolio projects")).finally(()=>d(!1))};r.useEffect(()=>{b()},[]),r.useEffect(()=>{b()},[j]);const m=r.useMemo(()=>Object.keys(c).filter(t=>c[t]).map(t=>Number(t)).filter(Boolean),[c]),P=r.useMemo(()=>i.length?i.every(t=>c[String(t.id)]):!1,[i,c]),A=t=>{const s={};i.forEach(N=>{s[String(N.id)]=t}),g(s)},E=t=>{g(s=>({...s,[String(t)]:!s[String(t)]}))},O=()=>{m.length&&window.confirm(`Delete ${m.length} project(s)? This cannot be undone.`)&&(d(!0),n(""),fetch(route("admin.portfolio-projects.bulk-destroy"),{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":v(),Accept:"application/json"},body:JSON.stringify({ids:m})}).then(async t=>{const s=await f(t);if(!t.ok)throw new Error(s?.message||"Bulk delete failed");g({}),b()}).catch(t=>n(t?.message||"Bulk delete failed")).finally(()=>d(!1)))},T=()=>{window.location.href=route("admin.portfolio-projects.export")+j},F=()=>{n(""),a(t=>({...t,type:"featured",name:"",slug:"",location:"",year:"",category:"",value:"",expected:"",progress:"",desc:"",features:"",occupied_by:"",status_updates:"",testimonial:"",sort_order:0,is_published:!0})),u(!0)},q=()=>{if(!l.name){n("Project name is required");return}d(!0),n(""),fetch(route("admin.portfolio-projects.store"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":v(),Accept:"application/json"},body:JSON.stringify({...l,year:l.year?Number(l.year):null,sort_order:Number(l.sort_order||0)})}).then(async t=>{const s=await f(t);if(!t.ok)throw new Error(s?.message||"Failed to create project");u(!1),b()}).catch(t=>n(t?.message||"Failed to create project")).finally(()=>d(!1))},L=[{value:"all",label:"All types"},{value:"featured",label:"Featured"},{value:"ongoing",label:"Ongoing"}],R=[{value:"all",label:"All"},{value:"1",label:"Published"},{value:"0",label:"Hidden"}],M=r.useMemo(()=>[{key:"projects",label:"Projects",href:route("admin.portfolio-projects")},{key:"gallery",label:"Gallery",href:route("admin.portfolio.gallery")},{key:"testimonials",label:"Testimonials",href:route("admin.portfolio.testimonials")},{key:"awards",label:"Awards",href:route("admin.portfolio.awards")}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Portfolio Projects"}),e.jsx(B,{title:"Portfolio",active:"projects",items:M,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-end lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Portfolio projects"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"These projects power the public Portfolio page (Featured + Ongoing). Add/edit data here."})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[e.jsx("button",{type:"button",onClick:F,disabled:o,className:"inline-flex items-center justify-center rounded-xl bg-slate-900 px-3 py-2 text-[12px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:"Add project"}),e.jsx("button",{type:"button",onClick:T,disabled:o,className:"inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 shadow-sm hover:bg-slate-50 disabled:opacity-60",children:"Export Excel"})]})]}),e.jsxs("div",{className:"mt-5 grid gap-3 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-5",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Search"}),e.jsx("input",{value:h,onChange:t=>k(t.target.value),placeholder:"Search name, slug, location...",className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] text-slate-900 placeholder:text-slate-400 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500/20"})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Type"}),e.jsx("select",{value:x,onChange:t=>S(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] text-slate-900 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500/20",children:L.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Published"}),e.jsx("select",{value:p,onChange:t=>C(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] text-slate-900 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500/20",children:R.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Bulk actions"}),e.jsxs("button",{type:"button",onClick:O,disabled:o||!m.length,className:"mt-1 w-full rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-[12px] font-semibold text-rose-700 hover:bg-rose-100 disabled:opacity-60",children:["Bulk delete (",m.length,")"]})]})]}),y?e.jsx("div",{className:"mt-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-[12px] text-rose-700",children:y}):null,e.jsx("div",{className:"mt-5 overflow-hidden rounded-2xl border border-slate-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:P,onChange:t=>A(t.target.checked),className:"h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-900"})}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Year"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Published"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Slug"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 bg-white",children:[o&&!i.length?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"Loading..."})}):null,!o&&!i.length?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"No projects found."})}):null,i.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:!!c[String(t.id)],onChange:()=>E(t.id),className:"h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-900"})}),e.jsx("td",{className:"px-4 py-3 text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:String(t.type||"").replace(/_/g," ")}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:t.location||"-"}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:t.year||"-"}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:t.category||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex items-center rounded-full border px-2 py-1 text-[11px] font-semibold "+(t.is_published?"border-emerald-200 bg-emerald-50 text-emerald-800":"border-slate-200 bg-slate-50 text-slate-700"),children:t.is_published?"Yes":"No"})}),e.jsx("td",{className:"px-4 py-3 text-[12px] font-mono text-slate-600",children:t.slug})]},t.id))]})]})})}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-[11px] text-slate-500",children:[e.jsxs("div",{children:["Showing ",i.length," project(s)"]}),e.jsx("div",{children:o?"Updating...":"Live"})]})]}),_?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>u(!1)}),e.jsxs("div",{className:"relative w-full max-w-3xl overflow-hidden rounded-3xl bg-white shadow-2xl ring-1 ring-black/5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 border-b border-slate-200 p-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-black tracking-tight text-slate-900",children:"Add portfolio project"}),e.jsxs("div",{className:"mt-1 text-[12px] text-slate-600",children:["For ongoing projects, you can paste status updates as: ",e.jsx("span",{className:"font-mono",children:"label | value"})]})]}),e.jsx("button",{type:"button",onClick:()=>u(!1),className:"inline-flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-100 text-slate-700 transition hover:bg-slate-200","aria-label":"Close",children:"Ã—"})]}),e.jsx("div",{className:"max-h-[70vh] overflow-y-auto p-6",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Type"}),e.jsxs("select",{value:l.type,onChange:t=>a(s=>({...s,type:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"featured",children:"Featured"}),e.jsx("option",{value:"ongoing",children:"Ongoing"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[e.jsx("input",{id:"is_published",type:"checkbox",checked:!!l.is_published,onChange:t=>a(s=>({...s,is_published:t.target.checked})),className:"h-4 w-4 rounded border-slate-300"}),e.jsx("label",{htmlFor:"is_published",className:"text-[12px] font-semibold text-slate-700",children:"Published"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Name *"}),e.jsx("input",{value:l.name,onChange:t=>a(s=>({...s,name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Project name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Slug (optional)"}),e.jsx("input",{value:l.slug,onChange:t=>a(s=>({...s,slug:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"auto-generated if empty"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Location"}),e.jsx("input",{value:l.location,onChange:t=>a(s=>({...s,location:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Kigamboni, Dar es Salaam"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Year (featured)"}),e.jsx("input",{value:l.year,onChange:t=>a(s=>({...s,year:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"2025"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Category"}),e.jsx("input",{value:l.category,onChange:t=>a(s=>({...s,category:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Luxury Residential"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Value (featured)"}),e.jsx("input",{value:l.value,onChange:t=>a(s=>({...s,value:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"TZS 4.5 Billion"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Sort order"}),e.jsx("input",{value:l.sort_order,onChange:t=>a(s=>({...s,sort_order:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Expected (ongoing)"}),e.jsx("input",{value:l.expected,onChange:t=>a(s=>({...s,expected:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"December 2026"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Progress (ongoing)"}),e.jsx("input",{value:l.progress,onChange:t=>a(s=>({...s,progress:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"65% Complete"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Description"}),e.jsx("textarea",{value:l.desc,onChange:t=>a(s=>({...s,desc:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",rows:3})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Features (one per line)"}),e.jsx("textarea",{value:l.features,onChange:t=>a(s=>({...s,features:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-mono",rows:4})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Occupied by (one per line)"}),e.jsx("textarea",{value:l.occupied_by,onChange:t=>a(s=>({...s,occupied_by:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-mono",rows:3})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Status updates (ongoing) - one per line"}),e.jsx("textarea",{value:l.status_updates,onChange:t=>a(s=>({...s,status_updates:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-mono",rows:3,placeholder:"Site clearing | 100%"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Testimonial (optional)"}),e.jsx("textarea",{value:l.testimonial,onChange:t=>a(s=>({...s,testimonial:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",rows:3})]})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 p-6",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),disabled:o,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"}),e.jsx("button",{type:"button",onClick:q,disabled:o,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"})]})]})]}):null]})})]})}export{U as default};
