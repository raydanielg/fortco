import{r as l,j as e,H as I}from"./app-_tcWvRHw.js";import{R as W}from"./RealEstatePanelLayout-MWmKt_Sl.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function Y(){const[c,n]=l.useState("all"),[p,d]=l.useState(!1),[y,r]=l.useState(""),[N,M]=l.useState([]),[v,w]=l.useState(!0),[u,q]=l.useState(""),[b,A]=l.useState([]),[P,C]=l.useState(!0),[g,S]=l.useState(""),[a,o]=l.useState({title:"",category_id:"",type:"House",status:"For Sale",location:"",price:"",beds:"",baths:"",size:"",image:"",featured:!1,description:""}),[k,F]=l.useState(null),[R,L]=l.useState(""),[E,f]=l.useState(null),h=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",x=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},T=l.useMemo(()=>[{key:"properties",label:"Properties",href:route("admin.real-estate.properties")},{key:"bookings",label:"Bookings",href:route("admin.real-estate.bookings")},{key:"clients",label:"Clients",href:route("admin.real-estate.clients")}],[]),X=l.useMemo(()=>["House","Apartment","Plot/Land","Commercial","Rental"],[]),z=l.useMemo(()=>["For Sale","For Rent","For Lease"],[]),j=()=>{C(!0),r(""),fetch(route("admin.real-estate.property-categories.data"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await x(t);if(!t.ok)throw new Error(s?.message||"Failed to load categories");A(Array.isArray(s?.categories)?s.categories:[])}).catch(t=>r(t?.message||"Failed to load categories")).finally(()=>C(!1))},m=()=>{w(!0),r("");const t=new URL(route("admin.real-estate.properties.data"));u.trim()&&t.searchParams.set("q",u.trim()),fetch(t.toString(),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async s=>{const i=await x(s);if(!s.ok)throw new Error(i?.message||"Failed to load properties");M(Array.isArray(i?.properties)?i.properties:[])}).catch(s=>r(s?.message||"Failed to load properties")).finally(()=>w(!1))};l.useEffect(()=>{m(),j()},[]);const H=()=>{if(!a.title.trim()){r("Title is required"),n("create");return}d(!0),r("");const t=new FormData;t.append("title",a.title),a.category_id&&t.append("category_id",String(a.category_id)),t.append("type",a.type),t.append("status",a.status),a.location&&t.append("location",a.location),a.price&&t.append("price",a.price),a.beds!==""&&t.append("beds",String(a.beds)),a.baths!==""&&t.append("baths",String(a.baths)),a.size&&t.append("size",a.size),a.description&&t.append("description",a.description),t.append("featured",a.featured?"1":"0"),k&&t.append("image_file",k),fetch(route("admin.real-estate.properties.store"),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":h()},body:t}).then(async s=>{const i=await x(s);if(!s.ok)throw new Error(i?.message||"Failed to create property");o({title:"",category_id:"",type:"House",status:"For Sale",location:"",price:"",beds:"",baths:"",size:"",image:"",featured:!1,description:""}),F(null),L(""),n("all"),m()}).catch(s=>r(s?.message||"Failed to create property")).finally(()=>d(!1))},O=t=>{confirm("Delete this property?")&&(d(!0),r(""),fetch(route("admin.real-estate.properties.destroy",t),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":h()}}).then(async s=>{const i=await x(s);if(!s.ok)throw new Error(i?.message||"Failed to delete property");m()}).catch(s=>r(s?.message||"Failed to delete property")).finally(()=>d(!1)))},_=()=>{if(!g.trim()){r("Category name is required"),n("categories");return}d(!0),r(""),fetch(route("admin.real-estate.property-categories.store"),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":h()},body:JSON.stringify({name:g.trim()})}).then(async t=>{const s=await x(t);if(!t.ok)throw new Error(s?.message||"Failed to create category");S(""),j()}).catch(t=>r(t?.message||"Failed to create category")).finally(()=>d(!1))},D=t=>{confirm("Delete this category?")&&(d(!0),r(""),fetch(route("admin.real-estate.property-categories.destroy",t),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json","X-CSRF-TOKEN":h()}}).then(async s=>{const i=await x(s);if(!s.ok)throw new Error(i?.message||"Failed to delete category");j(),m()}).catch(s=>r(s?.message||"Failed to delete category")).finally(()=>d(!1)))};return e.jsxs(W,{title:"Real Estate",active:"properties",items:T,children:[e.jsx(I,{title:"Real Estate - Properties"}),e.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Properties"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Manage your property listings."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("all"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold "+(c==="all"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"All Properties"}),e.jsx("button",{type:"button",onClick:()=>n("create"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold "+(c==="create"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"Create"}),e.jsx("button",{type:"button",onClick:()=>n("categories"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold "+(c==="categories"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"Categories"})]})]})}),e.jsxs("div",{className:"p-6",children:[y?e.jsx("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-[12px] text-rose-700",children:y}):null,c==="all"?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"All properties"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[e.jsxs("div",{className:"relative w-full sm:w-80",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400",children:e.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-4.3-4.3m1.8-4.7a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{value:u,onChange:t=>q(t.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 pl-9 text-[12px]",placeholder:"Search title, type, status, location"})]}),e.jsx("button",{type:"button",onClick:m,disabled:v,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Search"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left text-[12px]",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Image"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Title"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Location"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Category"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700",children:"Featured"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-slate-700"})]})}),e.jsx("tbody",{children:v?Array.from({length:6}).map((t,s)=>e.jsx("tr",{className:"border-b border-slate-100",children:e.jsx("td",{className:"px-4 py-3",colSpan:9,children:e.jsx("div",{className:"h-4 w-full animate-pulse rounded bg-slate-100"})})},s)):N.length?N.map(t=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3",children:t.image?e.jsx("img",{src:t.image,alt:"",className:"h-9 w-12 rounded-lg border border-slate-200 object-cover"}):e.jsx("div",{className:"h-9 w-12 rounded-lg border border-slate-200 bg-slate-50"})}),e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:t.title}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.type}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.status}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.location||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.price||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.category?.name||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.featured?"Yes":"No"}),e.jsxs("td",{className:"relative px-4 py-3 text-right",children:[e.jsx("button",{type:"button",onClick:()=>f(E===t.id?null:t.id),className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-200 bg-white hover:bg-slate-50",children:e.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM12 13.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3zM12 20.5a1.5 1.5 0 110-3 1.5 1.5 0 010 3z"})})}),E===t.id?e.jsxs("div",{className:"absolute right-4 top-12 z-20 w-44 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",children:[e.jsx("button",{type:"button",onClick:()=>{f(null),alert("Coming soon")},className:"block w-full px-4 py-2 text-left text-[12px] hover:bg-slate-50",children:"View"}),e.jsx("button",{type:"button",onClick:()=>{f(null),O(t.id)},className:"block w-full px-4 py-2 text-left text-[12px] text-rose-700 hover:bg-rose-50",children:"Delete"})]}):null]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{className:"px-4 py-8 text-center text-slate-500",colSpan:9,children:"No properties found"})})})]})})]}):null,c==="create"?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Property details"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Fields marked with * are required."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[12px] font-semibold text-slate-700",children:["Title ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:a.title,onChange:t=>o(s=>({...s,title:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. Modern Family House in Mikocheni"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Category"}),e.jsxs("select",{value:a.category_id,onChange:t=>o(s=>({...s,category_id:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"None"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[12px] font-semibold text-slate-700",children:["Type ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("select",{value:a.type,onChange:t=>o(s=>({...s,type:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:X.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[12px] font-semibold text-slate-700",children:["Status ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("select",{value:a.status,onChange:t=>o(s=>({...s,status:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:z.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Location"}),e.jsx("input",{value:a.location,onChange:t=>o(s=>({...s,location:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. Dar es Salaam"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Price"}),e.jsx("input",{value:a.price,onChange:t=>o(s=>({...s,price:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. TZS 480,000,000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Beds"}),e.jsx("input",{value:a.beds,onChange:t=>o(s=>({...s,beds:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",inputMode:"numeric",placeholder:"e.g. 4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Baths"}),e.jsx("input",{value:a.baths,onChange:t=>o(s=>({...s,baths:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",inputMode:"numeric",placeholder:"e.g. 3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Size"}),e.jsx("input",{value:a.size,onChange:t=>o(s=>({...s,size:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. 320 mÂ²"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Image URL"}),e.jsx("input",{value:a.image,onChange:t=>o(s=>({...s,image:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. /slides/beautiful-view...jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Upload image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>{const s=t.target.files?.[0]||null;F(s),L(s?URL.createObjectURL(s):"")},className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"}),R?e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:R,alt:"",className:"h-28 w-full rounded-xl border border-slate-200 object-cover"})}):null]}),e.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[e.jsx("input",{id:"featured",type:"checkbox",checked:!!a.featured,onChange:t=>o(s=>({...s,featured:t.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-slate-900"}),e.jsx("label",{htmlFor:"featured",className:"text-[12px] font-semibold text-slate-700",children:"Featured"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"text-[12px] font-semibold text-slate-700",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:t=>o(s=>({...s,description:t.target.value})),rows:4,className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Short description..."})]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{r(""),n("all")},className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:H,disabled:p,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:p?"Saving...":"Save Property"})]})]}):null,c==="categories"?e.jsxs("div",{className:"grid gap-4 lg:grid-cols-[1fr,360px]",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[e.jsx("div",{className:"border-b border-slate-200 bg-slate-50 px-4 py-3",children:e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"All categories"})}),e.jsx("div",{className:"divide-y divide-slate-100",children:P?Array.from({length:6}).map((t,s)=>e.jsx("div",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 w-full animate-pulse rounded bg-slate-100"})},s)):b.length?b.map(t=>e.jsxs("div",{className:"flex items-center justify-between gap-3 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("button",{type:"button",onClick:()=>D(t.id),disabled:p,className:"rounded-lg border border-rose-200 bg-rose-50 px-3 py-1.5 text-[12px] font-semibold text-rose-700 hover:bg-rose-100 disabled:opacity-60",children:"Delete"})]},t.id)):e.jsx("div",{className:"px-4 py-8 text-center text-[12px] text-slate-500",children:"No categories yet"})})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Create category"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{className:"text-[12px] font-semibold text-slate-700",children:["Name ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:g,onChange:t=>S(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. Residential"})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{type:"button",onClick:_,disabled:p,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:p?"Saving...":"Save"})})]})]}):null]})]})}export{Y as default};
