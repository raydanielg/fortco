import{r,j as e,H as y}from"./app-Be5uCMNC.js";import{D as j}from"./DashboardLayout-BxHtKg-F.js";function N(){const[c,a]=r.useState(!1),[m,i]=r.useState(""),[n,f]=r.useState([]),[o,b]=r.useState(""),[x,p]=r.useState(""),u=async s=>{const t=await s.text();try{return t?JSON.parse(t):{}}catch{return{}}},l=()=>{a(!0),i(""),fetch(route("admin.role-permission.data"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async s=>{const t=await u(s);if(!s.ok)throw new Error(t?.message||"Failed to load permissions");f(Array.isArray(t?.permissions)?t.permissions:[])}).catch(s=>i(s?.message||"Failed to load permissions")).finally(()=>a(!1))};r.useEffect(()=>{l()},[]);const h=r.useMemo(()=>{const s=o.trim().toLowerCase();return s?n.filter(t=>String(t?.name||"").toLowerCase().includes(s)):n},[n,o]),g=()=>{const s=x.trim();s&&(a(!0),i(""),fetch(route("admin.role-permission.permissions.store"),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:s})}).then(async t=>{const d=await u(t);if(!t.ok)throw new Error(d?.message||d?.errors?.name?.[0]||"Create permission failed");p(""),l()}).catch(t=>i(t?.message||"Create permission failed")).finally(()=>a(!1)))};return e.jsxs(j,{title:"User Management",breadcrumbs:["Admin","User Management","Permissions"],children:[e.jsx(y,{title:"Permissions"}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Permissions"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Create and view permissions (Spatie)."})]}),e.jsx("div",{className:"text-[12px] text-slate-500",children:c?"Workingâ€¦":""})]}),e.jsxs("div",{className:"mt-4 grid gap-2 md:grid-cols-3",children:[e.jsx("input",{value:o,onChange:s=>b(s.target.value),placeholder:"Search permissions",className:"md:col-span-1 w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] text-slate-900 placeholder:text-slate-400 focus:border-primary-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-primary-500/20"}),e.jsxs("div",{className:"md:col-span-2 flex flex-wrap items-center gap-2",children:[e.jsx("input",{value:x,onChange:s=>p(s.target.value),placeholder:"e.g. view_users",className:"flex-1 min-w-[220px] rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] text-slate-900 placeholder:text-slate-400 focus:border-primary-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-primary-500/20"}),e.jsx("button",{type:"button",onClick:g,disabled:c,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-50",children:"Add"}),e.jsx("button",{type:"button",onClick:l,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Refresh"})]})]})]}),e.jsxs("div",{className:"p-6",children:[m?e.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-[12px] text-red-700",children:m}):null,e.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:h.length?h.map(s=>e.jsx("div",{className:"rounded-xl border border-slate-200 bg-white px-4 py-3",children:e.jsx("div",{className:"font-mono text-[12px] font-semibold text-slate-900",children:s.name})},s.id)):e.jsx("div",{className:"text-[12px] text-slate-500",children:"No permissions found."})}),e.jsx("div",{className:"mt-4 text-[12px] text-slate-500",children:"Delete actions can be added here next (we already have delete endpoint in backend)."})]})]})]})}export{N as default};
