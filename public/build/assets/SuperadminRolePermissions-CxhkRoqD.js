import{b as H,r,j as e,a}from"./app-Be5uCMNC.js";import K from"./SettingsSectionShell-BKQE600h.js";function T(){const u=H().props.rolePermissionSettings||{},n=Array.isArray(u.roles)?u.roles:[],v=Array.isArray(u.permissions)?u.permissions:[],[m,b]=r.useState("roles"),[p,t]=r.useState(!1),[w,l]=r.useState(""),[S,C]=r.useState(""),[R,k]=r.useState(""),[j,N]=r.useState(null),[E,h]=r.useState(""),[i,P]=r.useState(n?.[0]?.id||null),A=r.useMemo(()=>n.find(s=>s.id===i)||null,[n,i]),[f,F]=r.useState(()=>new Set),g="w-full rounded-lg border border-slate-200 bg-white px-4 py-3 text-[12px] text-slate-900 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500/20",y=s=>"inline-flex items-center border-b-2 px-4 py-3 text-[12px] font-semibold transition "+(s?"border-slate-900 text-slate-900":"border-transparent text-slate-500 hover:text-slate-900"),o=()=>{a.get(route("admin.settings",{tab:"superadmin_role_permissions"}),{},{preserveScroll:!0})},d=s=>{const c=s?.errors?.name?.[0]||s?.message||"Request failed.";l(String(c))},_=()=>{l("");const s=S.trim();s&&(t(!0),a.post(route("admin.role-permission.roles.store"),{name:s},{preserveScroll:!0,onSuccess:()=>{C(""),o()},onError:d,onFinish:()=>t(!1)}))},D=s=>{N(s.id),h(s.name),l("")},I=()=>{l("");const s=E.trim();!j||!s||(t(!0),a.put(route("admin.role-permission.roles.update",j),{name:s},{preserveScroll:!0,onSuccess:()=>{N(null),h(""),o()},onError:d,onFinish:()=>t(!1)}))},q=s=>{l(""),window.confirm("Delete this role?")&&(t(!0),a.delete(route("admin.role-permission.roles.destroy",s),{preserveScroll:!0,onSuccess:()=>{i===s&&P(null),o()},onError:d,onFinish:()=>t(!1)}))},B=()=>{l("");const s=R.trim();s&&(t(!0),a.post(route("admin.role-permission.permissions.store"),{name:s},{preserveScroll:!0,onSuccess:()=>{k(""),o()},onError:d,onFinish:()=>t(!1)}))},J=s=>{l(""),window.confirm("Delete this permission?")&&(t(!0),a.delete(route("admin.role-permission.permissions.destroy",s),{preserveScroll:!0,onSuccess:()=>o(),onError:d,onFinish:()=>t(!1)}))},W=()=>{l(""),i&&(t(!0),a.put(route("admin.role-permission.roles.permissions.sync",i),{permissions:Array.from(f)},{preserveScroll:!0,onSuccess:()=>o(),onError:d,onFinish:()=>t(!1)}))},M=s=>{P(s),l("");const c=n.find(G=>G.id===s),x=new Set(Array.isArray(c?.permission_names)?c.permission_names:[]);F(x)},z=({name:s})=>{const c=f.has(s);return e.jsxs("label",{className:"flex items-start gap-3 rounded-xl border border-slate-200 bg-white p-3",children:[e.jsx("input",{type:"checkbox",className:"mt-1 h-4 w-4 rounded border-slate-300 text-primary-600 focus:ring-primary-500",checked:c,onChange:()=>{const x=new Set(f);x.has(s)?x.delete(s):x.add(s),F(x)}}),e.jsx("div",{children:e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:s})})]})};return e.jsx(K,{title:"",description:"",children:e.jsxs("div",{className:"-m-5 overflow-hidden rounded-2xl border border-slate-200 bg-white",children:[e.jsx("div",{className:"border-b border-slate-200 bg-white",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{type:"button",onClick:()=>b("roles"),className:y(m==="roles"),children:"Roles"}),e.jsx("button",{type:"button",onClick:()=>b("permissions"),className:y(m==="permissions"),children:"Permissions"}),e.jsx("button",{type:"button",onClick:()=>b("manage"),className:y(m==="manage"),children:"Manage"})]}),e.jsx("div",{className:"my-3 text-[12px] text-slate-500",children:p?"Workingâ€¦":""})]})}),e.jsxs("div",{className:"p-6",children:[w?e.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-[12px] text-red-700",children:w}):null,m==="roles"?e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Add Role"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"Role name"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{value:S,onChange:s=>C(s.target.value),className:g,placeholder:"e.g. Manager"})})]}),e.jsx("button",{type:"button",onClick:_,disabled:p,className:"mt-4 inline-flex w-full items-center justify-center rounded-xl bg-red-600 px-5 py-2.5 text-[12px] font-bold text-white transition hover:bg-red-700 disabled:opacity-50",children:"Add"})]})}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Roles"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Create, update, and delete roles."})]}),e.jsx("div",{className:"divide-y divide-slate-200",children:n.length?n.map(s=>e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-5 py-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[13px] font-semibold text-slate-900",children:s.name}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:(Array.isArray(s.permission_names)?s.permission_names.length:0)+" permissions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{b("manage"),M(s.id)},className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Manage"}),e.jsx("button",{type:"button",onClick:()=>D(s),className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>q(s.id),className:"rounded-xl border border-red-200 bg-white px-4 py-2 text-[12px] font-semibold text-red-700 hover:bg-red-50",children:"Delete"})]})]},s.id)):e.jsx("div",{className:"px-5 py-6 text-[12px] text-slate-500",children:"No roles found."})})]}),j?e.jsxs("div",{className:"mt-5 rounded-2xl border border-slate-200 bg-slate-50 p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit Role"}),e.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{value:E,onChange:s=>h(s.target.value),className:g})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:I,disabled:p,className:"inline-flex flex-1 items-center justify-center rounded-xl bg-red-600 px-5 py-2.5 text-[12px] font-bold text-white transition hover:bg-red-700 disabled:opacity-50",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>{N(null),h("")},className:"inline-flex flex-1 items-center justify-center rounded-xl border border-slate-200 bg-white px-5 py-2.5 text-[12px] font-bold text-slate-700 hover:bg-slate-50",children:"Cancel"})]})]})]}):null]})]}):m==="permissions"?e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Add Permission"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-500",children:"Permission name"}),e.jsx("div",{className:"mt-2",children:e.jsx("input",{value:R,onChange:s=>k(s.target.value),className:g,placeholder:"e.g. view_users"})})]}),e.jsx("button",{type:"button",onClick:B,disabled:p,className:"mt-4 inline-flex w-full items-center justify-center rounded-xl bg-red-600 px-5 py-2.5 text-[12px] font-bold text-white transition hover:bg-red-700 disabled:opacity-50",children:"Add"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Permissions"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Create and delete permissions."})]}),e.jsx("div",{className:"divide-y divide-slate-200",children:v.length?v.map(s=>e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 px-5 py-4",children:[e.jsx("div",{className:"font-mono text-[12px] font-semibold text-slate-900",children:s.name}),e.jsx("button",{type:"button",onClick:()=>J(s.id),className:"rounded-xl border border-red-200 bg-white px-4 py-2 text-[12px] font-semibold text-red-700 hover:bg-red-50",children:"Delete"})]},s.id)):e.jsx("div",{className:"px-5 py-6 text-[12px] text-slate-500",children:"No permissions found."})})]})})]}):e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-5",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Select Role"}),e.jsx("div",{className:"mt-4",children:e.jsxs("select",{value:i||"",onChange:s=>M(Number(s.target.value)),className:g,children:[e.jsx("option",{value:"",disabled:!0,children:"Choose role"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})}),e.jsx("button",{type:"button",onClick:W,disabled:p||!i,className:"mt-4 inline-flex w-full items-center justify-center rounded-xl bg-red-600 px-5 py-2.5 text-[12px] font-bold text-white transition hover:bg-red-700 disabled:opacity-50",children:"Save"}),e.jsx("div",{className:"mt-4 text-[12px] text-slate-500",children:"Role permissions will be updated based on your selection."})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Manage Permissions"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:A?e.jsxs(e.Fragment,{children:["Editing role: ",e.jsx("span",{className:"font-semibold text-slate-900",children:A.name})]}):"Select a role to manage."})]}),e.jsx("div",{className:"p-5",children:i?e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:v.map(s=>e.jsx(z,{name:s.name},s.id))}):e.jsx("div",{className:"text-[12px] text-slate-500",children:"Choose a role to see permissions."})})]})})]})]})]})})}export{T as default};
