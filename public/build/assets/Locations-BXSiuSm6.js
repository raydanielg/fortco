import{r as o,j as e,H as z}from"./app-_tcWvRHw.js";import{C as D}from"./ConstructionPanelLayout-smiwN9nJ.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function _(){const[b,g]=o.useState("all"),[i,n]=o.useState(!1),[w,a]=o.useState(""),[p,A]=o.useState([]),[l,y]=o.useState({region:"",country:""}),[M,C]=o.useState(!1),[d,j]=o.useState(""),[K,k]=o.useState(!1),[S,R]=o.useState(""),[r,x]=o.useState({name:"",region:"",country:""}),f=o.useMemo(()=>({Tanzania:["Arusha","Dar es Salaam","Dodoma","Geita","Iringa","Kagera","Katavi","Kigoma","Kilimanjaro","Lindi","Manyara","Mara","Mbeya","Morogoro","Mtwara","Mwanza","Njombe","Pwani (Coast)","Rukwa","Ruvuma","Shinyanga","Simiyu","Singida","Songwe","Tabora","Tanga","Kaskazini Unguja","Kusini Unguja","Mjini Magharibi","Kaskazini Pemba","Kusini Pemba"],Kenya:["Nairobi","Mombasa","Kisumu","Nakuru","Kiambu"],Uganda:["Kampala","Wakiso","Mukono","Jinja"],Rwanda:["Kigali","Eastern Province","Northern Province","Western Province","Southern Province"]}),[]),E=o.useMemo(()=>Object.keys(f),[f]),h=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",m=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},L=o.useMemo(()=>[{key:"projects",label:"Projects",href:route("admin.construction.projects")},{key:"create",label:"Create Projects",href:route("admin.construction.projects.create")},{key:"categories",label:"Project Categories",href:route("admin.construction.project-categories")},{key:"locations",label:"Locations",href:route("admin.construction.locations")},{key:"materials",label:"Materials",href:route("admin.construction.materials")},{key:"workers",label:"Workers",href:route("admin.construction.workers")}],[]),c=()=>{n(!0),a(""),fetch(route("admin.construction.locations.data"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await m(t);if(!t.ok)throw new Error(s?.message||"Failed to load locations");A(Array.isArray(s?.locations)?s.locations:[])}).catch(t=>a(t?.message||"Failed to load locations")).finally(()=>n(!1))};o.useEffect(()=>{c()},[]);const T=()=>{if(!l.country){a("Country is required");return}if(!l.region.trim()){a("Region is required");return}n(!0),a(""),fetch(route("admin.construction.locations.store"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"},body:JSON.stringify({name:l.region.trim(),region:l.region.trim(),country:l.country})}).then(async t=>{const s=await m(t);if(!t.ok)throw new Error(s?.message||"Failed to create location");y({region:"",country:""}),g("all"),c()}).catch(t=>a(t?.message||"Failed to create location")).finally(()=>n(!1))},q=()=>{a(""),j(""),C(!0)},N=()=>{C(!1),j("")},O=()=>{if(!d){a("Country is required");return}n(!0),a(""),fetch(route("admin.construction.locations.auto-create"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"},body:JSON.stringify({country:d})}).then(async t=>{const s=await m(t);if(!t.ok)throw new Error(s?.message||"Failed to create location");N(),c()}).catch(t=>a(t?.message||"Failed to create location")).finally(()=>n(!1))},P=t=>{if(!t?.id)return;const s=[t.name,t.region,t.country].filter(Boolean).join(", ");window.confirm(`Delete location "${s}"?`)&&(n(!0),a(""),fetch(route("admin.construction.locations.destroy",{location:t.id}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"}}).then(async u=>{const W=await m(u);if(!u.ok)throw new Error(W?.message||"Delete failed");c()}).catch(u=>a(u?.message||"Delete failed")).finally(()=>n(!1)))},X=t=>{a(""),R(String(t?.id||"")),x({name:String(t?.name||""),region:String(t?.region||""),country:String(t?.country||"")}),k(!0)},v=()=>{k(!1),R(""),x({name:"",region:"",country:""})},F=()=>{if(S){if(!r.name.trim()){a("Location name is required");return}n(!0),a(""),fetch(route("admin.construction.locations.update",{location:S}),{method:"PUT",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"},body:JSON.stringify({name:r.name.trim(),region:r.region.trim()||null,country:r.country.trim()||null})}).then(async t=>{const s=await m(t);if(!t.ok)throw new Error(s?.message||"Update failed");v(),c()}).catch(t=>a(t?.message||"Update failed")).finally(()=>n(!1))}};return e.jsxs(D,{title:"Construction",active:"locations",items:L,children:[e.jsx(z,{title:"Locations"}),e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Locations"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Create and manage locations used in Construction projects."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g("all"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(b==="all"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"All items"}),e.jsx("button",{type:"button",onClick:()=>g("create"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(b==="create"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"Create"})]})]}),e.jsxs("div",{className:"p-6",children:[w?e.jsx("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-[12px] text-rose-700",children:w}):null,b==="create"?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Create location"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Add a location to standardize reporting and tracking."}),e.jsxs("div",{className:"mt-5 grid gap-3 sm:grid-cols-3",children:[e.jsxs("div",{className:"sm:col-span-1",children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Country ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsxs("select",{value:l.country,onChange:t=>y(s=>({...s,country:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select country"}),E.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Region ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:l.region,onChange:t=>y(s=>({...s,region:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Type region e.g. Pwani (Coast)"}),e.jsx("div",{className:"mt-1 text-[11px] text-slate-500",children:"Location name will be saved as the region."})]})]}),e.jsx("div",{className:"mt-6 flex items-center justify-end",children:e.jsx("button",{type:"button",onClick:T,disabled:i,className:"rounded-xl bg-slate-900 px-5 py-2.5 text-[12px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:"Save"})})]}):e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"All locations"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:q,disabled:i,className:"rounded-xl bg-slate-900 px-3 py-2 text-[12px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:"Auto create"}),e.jsx("button",{type:"button",onClick:c,disabled:i,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Region"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Country"}),e.jsx("th",{className:"w-36 px-4 py-3 text-right text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 bg-white",children:[i&&!p.length?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"Loading..."})}):null,!i&&!p.length?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"No locations found."})}):null,p.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:t.region||"-"}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:t.country||"-"}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>X(t),disabled:i,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>P(t),disabled:i,className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-[12px] font-semibold text-rose-700 hover:bg-rose-100 disabled:opacity-60",children:"Delete"})]})})]},t.id))]})]})}),e.jsxs("div",{className:"border-t border-slate-200 px-4 py-3 text-[11px] text-slate-500",children:["Showing ",p.length," item(s)"]})]}),K?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("button",{type:"button",className:"absolute inset-0 bg-slate-900/40",onClick:v,"aria-label":"Close"}),e.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit location"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Update location details and save changes."})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Name ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:r.name,onChange:t=>x(s=>({...s,name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Location name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Region"}),e.jsx("input",{value:r.region,onChange:t=>x(s=>({...s,region:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Region"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Country"}),e.jsx("input",{value:r.country,onChange:t=>x(s=>({...s,country:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Country"})]})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:v,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:F,disabled:i,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"})]})]})]})]}):null,M?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("button",{type:"button",className:"absolute inset-0 bg-slate-900/40",onClick:N,"aria-label":"Close"}),e.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Auto create location"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Choose a country then we will create all regions for that country."})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("div",{className:"grid gap-3",children:e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Country ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsxs("select",{value:d,onChange:t=>j(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select country"}),E.map(t=>e.jsx("option",{value:t,children:t},t))]})]})}),d?e.jsxs("div",{className:"mt-3 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-[12px] text-slate-700",children:[e.jsx("div",{className:"text-[11px] font-semibold text-slate-600",children:"Regions to create"}),e.jsx("div",{className:"mt-1",children:(f[d]||[]).join(", ")||"No regions configured for this country."})]}):null,e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:N,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:O,disabled:i,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Create all"})]})]})]})]}):null]})]})}export{_ as default};
