import{r as a,j as e,H as P}from"./app-_tcWvRHw.js";import{C as H}from"./ConstructionPanelLayout-smiwN9nJ.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function z(){const[c,x]=a.useState("all"),[i,r]=a.useState(!1),[w,l]=a.useState(""),[o,A]=a.useState([]),[m,C]=a.useState(""),[p,S]=a.useState("pcs"),[u,k]=a.useState(""),[L,E]=a.useState(!1),[R,U]=a.useState(""),[b,h]=a.useState(""),[g,f]=a.useState("pcs"),[j,v]=a.useState(""),M=a.useMemo(()=>[{value:"pcs",label:"Pcs"},{value:"kg",label:"Kg"},{value:"ton",label:"Ton"},{value:"m",label:"Meter (m)"},{value:"m2",label:"Square meter (m²)"},{value:"m3",label:"Cubic meter (m³)"},{value:"bag",label:"Bag"},{value:"ltr",label:"Liter (L)"}],[]),y=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",d=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},X=a.useMemo(()=>[{key:"projects",label:"Projects",href:route("admin.construction.projects")},{key:"create",label:"Create Projects",href:route("admin.construction.projects.create")},{key:"categories",label:"Project Categories",href:route("admin.construction.project-categories")},{key:"locations",label:"Locations",href:route("admin.construction.locations")},{key:"materials",label:"Materials",href:route("admin.construction.materials")},{key:"workers",label:"Workers",href:route("admin.construction.workers")}],[]),n=()=>{r(!0),l(""),fetch(route("admin.construction.materials.data"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await d(t);if(!t.ok)throw new Error(s?.message||"Failed to load materials");A(Array.isArray(s?.materials)?s.materials:[])}).catch(t=>l(t?.message||"Failed to load materials")).finally(()=>r(!1))};a.useEffect(()=>{n()},[]);const _=()=>{if(!m.trim()){l("Material name is required");return}if(!p){l("Unit is required");return}r(!0),l(""),fetch(route("admin.construction.materials.store"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":y(),Accept:"application/json"},body:JSON.stringify({name:m.trim(),unit:p,unit_rate:u!==""?Number(u):null})}).then(async t=>{const s=await d(t);if(!t.ok)throw new Error(s?.message||"Failed to create material");C(""),S("pcs"),k(""),x("all"),n()}).catch(t=>l(t?.message||"Failed to create material")).finally(()=>r(!1))},O=t=>{t?.id&&window.confirm(`Delete material "${t.name}"?`)&&(r(!0),l(""),fetch(route("admin.construction.materials.destroy",{material:t.id}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":y(),Accept:"application/json"}}).then(async s=>{const q=await d(s);if(!s.ok)throw new Error(q?.message||"Delete failed");n()}).catch(s=>l(s?.message||"Delete failed")).finally(()=>r(!1)))},T=t=>{l(""),U(String(t?.id||"")),h(String(t?.name||"")),f(String(t?.unit||"pcs")),v(t?.unit_rate!==null&&t?.unit_rate!==void 0&&t?.unit_rate!==""?String(t.unit_rate):""),E(!0)},N=()=>{E(!1),U(""),h(""),f("pcs"),v("")},F=()=>{if(R){if(!b.trim()){l("Material name is required");return}if(!g){l("Unit is required");return}r(!0),l(""),fetch(route("admin.construction.materials.update",{material:R}),{method:"PUT",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":y(),Accept:"application/json"},body:JSON.stringify({name:b.trim(),unit:g,unit_rate:j!==""?Number(j):null})}).then(async t=>{const s=await d(t);if(!t.ok)throw new Error(s?.message||"Update failed");N(),n()}).catch(t=>l(t?.message||"Update failed")).finally(()=>r(!1))}};return e.jsxs(H,{title:"Construction",active:"materials",items:X,children:[e.jsx(P,{title:"Construction Materials"}),e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Materials"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Create and manage master materials list."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x("all"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(c==="all"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"All items"}),e.jsx("button",{type:"button",onClick:()=>x("create"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(c==="create"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"Create"})]})]}),e.jsxs("div",{className:"p-6",children:[w?e.jsx("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-[12px] text-rose-700",children:w}):null,c==="create"?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Create material"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Add a new material to use in projects and stock tracking."}),e.jsxs("div",{className:"mt-5 grid gap-3 sm:grid-cols-3",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Material name ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:m,onChange:t=>C(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. Cement"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Unit ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("select",{value:p,onChange:t=>S(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:M.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Unit rate"}),e.jsx("input",{value:u,onChange:t=>k(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. 25000"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:_,disabled:i,className:"w-full rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:"Save"})})]})]}):e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"All materials"}),e.jsx("button",{type:"button",onClick:n,disabled:i,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Name"}),e.jsx("th",{className:"w-24 px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Unit"}),e.jsx("th",{className:"w-36 px-4 py-3 text-right text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Rate"}),e.jsx("th",{className:"w-36 px-4 py-3 text-right text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 bg-white",children:[i&&!o.length?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"Loading..."})}):null,!i&&!o.length?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"No materials found."})}):null,o.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-[12px] text-slate-700",children:t.unit||"-"}),e.jsx("td",{className:"px-4 py-3 text-right text-[12px] text-slate-900",children:t.unit_rate!==null&&t.unit_rate!==void 0&&t.unit_rate!==""?Number(t.unit_rate).toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>T(t),disabled:i,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>O(t),disabled:i,className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-[12px] font-semibold text-rose-700 hover:bg-rose-100 disabled:opacity-60",children:"Delete"})]})})]},t.id))]})]})}),e.jsxs("div",{className:"border-t border-slate-200 px-4 py-3 text-[11px] text-slate-500",children:["Showing ",o.length," item(s)"]})]}),L?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("button",{type:"button",className:"absolute inset-0 bg-slate-900/40",onClick:N,"aria-label":"Close"}),e.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit material"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Update the material name and save changes."})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Material name ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:b,onChange:t=>h(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Material name"}),e.jsxs("div",{className:"mt-3 grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Unit ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("select",{value:g,onChange:t=>f(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:M.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Unit rate"}),e.jsx("input",{value:j,onChange:t=>v(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. 25000"})]})]}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:N,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:F,disabled:i,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"})]})]})]})]}):null]})]})}export{z as default};
