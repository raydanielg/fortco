import{r,j as e,H as P}from"./app-_tcWvRHw.js";import{C as S}from"./CompaniesPanelLayout-D2wewtRv.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function X(){const[x,n]=r.useState("all"),[b,i]=r.useState(!1),[u,l]=r.useState(""),[g,w]=r.useState([]),[j,f]=r.useState(!0),[m,y]=r.useState(""),[a,p]=r.useState({name:"",logo:null}),[d,v]=r.useState(""),N=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",h=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},k=r.useMemo(()=>[{key:"profile",label:"Profile",href:route("admin.companies.profile")},{key:"partners",label:"Partners",href:route("admin.companies.partners")},{key:"vendors",label:"Vendors",href:route("admin.companies.vendors")}],[]),c=()=>{f(!0),l("");const t=route("admin.companies.partners.data")+(m.trim()?`?q=${encodeURIComponent(m.trim())}`:"");fetch(t,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async s=>{const o=await h(s);if(!s.ok)throw new Error(o?.message||"Failed to load partners");w(Array.isArray(o?.partners)?o.partners:[])}).catch(s=>l(s?.message||"Failed to load partners")).finally(()=>f(!1))};r.useEffect(()=>{c()},[]),r.useEffect(()=>{if(!a.logo){d&&URL.revokeObjectURL(d),v("");return}const t=URL.createObjectURL(a.logo);return v(t),()=>URL.revokeObjectURL(t)},[a.logo]);const L=()=>{if(!a.name.trim()){l("Partner name is required");return}if(!a.logo){l("Logo is required");return}i(!0),l("");const t=new FormData;t.append("name",a.name.trim()),t.append("logo",a.logo),fetch(route("admin.companies.partners.store"),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":N(),Accept:"application/json"},body:t}).then(async s=>{const o=await h(s);if(!s.ok)throw new Error(o?.message||"Failed to register partner");p({name:"",logo:null}),n("all"),c()}).catch(s=>l(s?.message||"Failed to register partner")).finally(()=>i(!1))},C=t=>{t?.id&&window.confirm(`Delete partner "${t.name}"?`)&&(i(!0),l(""),fetch(route("admin.companies.partners.destroy",{partner:t.id}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":N(),Accept:"application/json"}}).then(async s=>{const o=await h(s);if(!s.ok)throw new Error(o?.message||"Delete failed");c()}).catch(s=>l(s?.message||"Delete failed")).finally(()=>i(!1)))},R=({i:t})=>e.jsxs("tr",{className:"animate-pulse",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-10 w-10 rounded-xl bg-slate-100"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 w-56 rounded bg-slate-100"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("div",{className:"ml-auto h-9 w-24 rounded-xl bg-slate-100"})})]},t);return e.jsxs(S,{title:"Companies",active:"partners",items:k,children:[e.jsx(P,{title:"Companies - Partners"}),e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Partners"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Upload partner logos and manage the partner list."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("all"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(x==="all"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"All partners"}),e.jsx("button",{type:"button",onClick:()=>n("register"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(x==="register"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"Register"})]})]}),e.jsxs("div",{className:"p-6",children:[u?e.jsx("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-[12px] text-rose-700",children:u}):null,x==="register"?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Register partner"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Add partner name and upload a logo."})]}),e.jsxs("div",{className:"hidden items-center gap-2 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] font-semibold text-slate-700 sm:flex",children:[e.jsxs("svg",{viewBox:"0 0 24 24",className:"h-5 w-5 animate-pulse",fill:"none",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 2l7 4v6c0 5-3 9-7 10-4-1-7-5-7-10V6l7-4z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4"})]}),"Partner Logo"]})]}),e.jsxs("div",{className:"mt-5 grid gap-4 lg:grid-cols-[1fr,320px]",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Partner name ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsx("input",{value:a.name,onChange:t=>p(s=>({...s,name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. Fortco Partners Ltd"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"text-[11px] font-semibold text-slate-700",children:["Logo ",e.jsx("span",{className:"text-rose-600",children:"*"})]}),e.jsxs("div",{className:"mt-1 flex flex-col gap-2 rounded-2xl border border-slate-200 bg-slate-50 p-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-white",children:e.jsx("svg",{viewBox:"0 0 24 24",className:"h-5 w-5 text-slate-700",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4-4 4 4 8-8"})})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-[12px] font-semibold text-slate-900",children:a.logo?a.logo.name:"Choose image file"}),e.jsx("div",{className:"mt-0.5 text-[11px] font-semibold text-slate-500",children:"Max 4MB"})]})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>p(s=>({...s,logo:t.target.files?.[0]||null})),className:"block w-full text-[12px] sm:w-[260px]"})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("all"),className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:L,disabled:b,className:"rounded-xl bg-slate-900 px-5 py-2.5 text-[12px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:"Save partner"})]})]}),e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"border-b border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"Preview"}),e.jsx("div",{className:"mt-1 text-[11px] font-semibold text-slate-500",children:"Preview your logo before saving."})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center justify-center rounded-2xl border border-dashed border-slate-200 bg-slate-50 p-6",children:d?e.jsx("img",{src:d,alt:"Logo preview",className:"max-h-44 w-auto rounded-xl bg-white p-3 shadow-sm"}):e.jsx("div",{className:"text-center text-[12px] text-slate-500",children:"No logo selected."})}),e.jsx("div",{className:"mt-3 text-center text-[12px] font-semibold text-slate-700",children:a.name||"Partner name"})]})]})]})]}):e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"All partners"}),e.jsxs("div",{className:"flex flex-1 flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[e.jsxs("div",{className:"relative w-full sm:w-72",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400",children:e.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-4.3-4.3m1.8-4.7a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{value:m,onChange:t=>y(t.target.value),className:"w-full rounded-xl border border-slate-200 bg-white px-3 py-2 pl-9 text-[12px]",placeholder:"Search partner"})]}),e.jsx("button",{type:"button",onClick:c,disabled:j,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Search"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-16 px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Logo"}),e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-right text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 bg-white",children:j?e.jsx(e.Fragment,{children:Array.from({length:6}).map((t,s)=>e.jsx(R,{i:s},s))}):g.length?g.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3",children:t.logo_url?e.jsx("img",{src:t.logo_url,alt:t.name,className:"h-10 w-10 rounded-xl border border-slate-200 bg-white object-contain p-1"}):e.jsx("div",{className:"h-10 w-10 rounded-xl border border-slate-200 bg-slate-50"})}),e.jsx("td",{className:"px-4 py-3 text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{type:"button",onClick:()=>C(t),disabled:b,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Delete"})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"No partners found."})})})]})})]})]})]})}export{X as default};
