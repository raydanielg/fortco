import{r as l,j as e,H as fe}from"./app-_tcWvRHw.js";import{A as ge}from"./AdminPanelLayout-0PjPupQC.js";import{D as ve}from"./DocumentPreview-B4pqgYPf.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function Ee(){const[o,m]=l.useState(!1),[L,i]=l.useState(""),[C,z]=l.useState([]),[f,H]=l.useState(""),[U,A]=l.useState(!1),[B,W]=l.useState(""),P=l.useRef(null),[g,u]=l.useState(""),E=l.useRef(null),[R,j]=l.useState(!1),[w,k]=l.useState(1),[D,T]=l.useState([]),[Y,N]=l.useState(!1),[O,$]=l.useState(""),[n,d]=l.useState({first_name:"",middle_name:"",last_name:"",hire_date:"",national_id:"",email:"",role:"",designation:"",phone:"",sex:""}),[J,M]=l.useState(!1),[I,K]=l.useState(""),[G,Q]=l.useState(""),[F,q]=l.useState(!1),[a,r]=l.useState({first_name:"",middle_name:"",last_name:"",hire_date:"",national_id:"",email:"",role:"",designation:"",phone:"",sex:"",password:"",password_confirm:""}),_=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",h=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},v=()=>{m(!0),i(""),fetch(route("admin.security.employees"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await h(t);if(!t.ok)throw new Error(s?.message||"Failed to load employees");z(Array.isArray(s?.employees)?s.employees:[])}).catch(t=>i(t?.message||"Failed to load employees")).finally(()=>m(!1))},V=t=>{const s=t?.user?.id||t?.user_id;s&&(K(String(s)),Q(String(t?.user?.email||"")),q(!1),M(!0))},Z=()=>{I&&(m(!0),i(""),fetch(route("admin.security.users.password-reset-default",{user:I}),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":_(),Accept:"application/json"}}).then(async t=>{const s=await h(t);if(!t.ok)throw new Error(s?.message||"Failed to reset password");q(!0)}).catch(t=>i(t?.message||"Failed to reset password")).finally(()=>m(!1)))},ee=t=>{t?.id&&($(String(t.id)),d({first_name:t?.first_name||"",middle_name:t?.middle_name||"",last_name:t?.last_name||"",hire_date:t?.hire_date?String(t.hire_date).slice(0,10):"",national_id:t?.national_id||"",email:t?.user?.email||"",role:t?.department||"",designation:t?.designation||"",phone:t?.phone||"",sex:t?.sex||""}),N(!0))},te=()=>{O&&(m(!0),i(""),fetch(route("admin.security.employees.update",{employee:O}),{method:"PUT",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":_(),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({first_name:n.first_name,middle_name:n.middle_name||null,last_name:n.last_name,hire_date:n.hire_date||null,national_id:n.national_id||null,email:n.email,role:n.role,designation:n.designation||null,phone:n.phone||null,sex:n.sex||null})}).then(async t=>{const s=await h(t);if(!t.ok){const c=s?.message||s?.errors?.email?.[0]||s?.errors?.role?.[0]||s?.errors?.first_name?.[0]||s?.errors?.last_name?.[0]||"Failed to update employee";throw new Error(c)}N(!1),$(""),v()}).catch(t=>i(t?.message||"Failed to update employee")).finally(()=>m(!1)))},se=()=>{fetch(route("admin.role-permission.data"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await h(t);if(!t.ok)throw new Error(s?.message||"Failed to load roles");T(Array.isArray(s?.roles)?s.roles:[])}).catch(()=>T([]))};l.useEffect(()=>{v()},[]),l.useEffect(()=>{R&&(k(1),se())},[R]),l.useEffect(()=>{const t=s=>{g&&E.current&&(E.current.contains(s.target)||u(""))};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[g]);const ae=t=>{const s=t?.user?.id||t?.user_id;s&&(window.location.href=route("admin.user-management.sessions-logs",{user:s}))},le=t=>{const s=t?.user?.id||t?.user_id;if(!s)return;const c=!!t?.user?.banned_at,b=c?"Unban":"Ban";window.confirm(`${b} ${t.full_name}?`)&&(m(!0),i(""),fetch(route(c?"admin.security.users.unban":"admin.security.users.ban",{user:s}),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":_(),Accept:"application/json"}}).then(async p=>{const y=await h(p);if(!p.ok)throw new Error(y?.message||"Action failed");v()}).catch(p=>i(p?.message||"Action failed")).finally(()=>m(!1)))},ne=()=>{try{const t=x=>String(x??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),s=(S||[]).map(x=>{const ue=x?.user?.banned_at?"Banned":x?.active?"Active":"Inactive",he=x?.last_activity?new Date(x.last_activity).toLocaleString():"-",be=x?.sessions_count??0;return`
                    <tr>
                        <td>${t(x?.full_name)}</td>
                        <td>${t(x?.user?.email||"")}</td>
                        <td>${t(x?.designation||"")}</td>
                        <td>${t(x?.phone||"")}</td>
                        <td class="num">${t(be)}</td>
                        <td>${t(he)}</td>
                        <td>${t(ue)}</td>
                    </tr>
                `}),c=new Date().toLocaleString(),b="EMPLOYEE ACCOUNTS REPORT",p="FORTCO ERP",y="ADMINISTRATION OFFICE",de="Tel: +255 000 000 000, Email: info@fortco.local",ce="This document provides an official summary of employees registered in the system, including contact details, recent session activity and account status.",X=(S||[]).length,xe=f.trim()?`Filter: "${t(f.trim())}"`:"Filter: None",me=`${window.location.origin}/favicon.svg`,pe=`
                <!doctype html>
                <html>
                <head>
                    <meta charset="utf-8" />
                    <meta name="viewport" content="width=device-width, initial-scale=1" />
                    <title>${b}</title>
                    <style>
                        :root { --ink:#0f172a; --muted:#475569; --line:#cbd5e1; --paper:#ffffff; --canvas:#e5e7eb; }
                        body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background: var(--canvas); color: var(--ink); margin: 0; padding: 24px; }
                        .page { max-width: 980px; margin: 0 auto; background: var(--paper); border: 1px solid var(--line); }
                        .top { padding: 18px 20px 10px 20px; text-align: center; }
                        .crest { width: 58px; height: 58px; margin: 0 auto 8px auto; display:flex; align-items:center; justify-content:center; overflow:hidden; }
                        .crest img { width: 58px; height: 58px; object-fit: contain; }
                        .top .l1 { font-size: 12px; font-weight: 800; letter-spacing: 0.05em; }
                        .top .l2 { font-size: 11px; font-weight: 800; margin-top: 2px; }
                        .top .l3 { font-size: 11px; color: var(--muted); margin-top: 3px; }
                        .title { margin-top: 10px; font-size: 12px; font-weight: 900; letter-spacing: 0.08em; }
                        .titleLine { margin-top: 6px; font-size: 12px; font-weight: 900; letter-spacing: 0.18em; }
                        .subTitle { margin-top: 6px; font-size: 11px; color: var(--muted); }
                        .body { padding: 0 20px 6px 20px; }
                        .section { padding: 14px 0; border-top: 1px dashed #cbd5e1; }
                        .section:first-child { border-top: 1px solid #cbd5e1; }
                        .section h2 { margin: 0 0 6px 0; font-size: 12px; font-weight: 900; letter-spacing: 0.02em; }
                        .section p { margin: 0; font-size: 11px; color: var(--muted); line-height: 1.55; }
                        .metaRow { margin-top: 10px; display:flex; flex-wrap: wrap; gap: 14px; font-size: 11px; color: var(--muted); }
                        .metaRow strong { color: var(--ink); }
                        table { width: 100%; border-collapse: collapse; font-size: 11px; margin-top: 10px; }
                        th, td { border: 1px solid var(--line); padding: 8px 9px; vertical-align: top; }
                        th { background: #f8fafc; text-align: left; font-weight: 900; }
                        td.num, th.num { text-align: right; }
                        .footer { border-top: 1px solid var(--line); padding: 10px 20px; display:flex; justify-content: space-between; gap: 12px; font-size: 11px; color: var(--muted); }
                        @media print { body { background:#fff; padding:0; } .page { border:none; max-width:none; } }
                    </style>
                </head>
                <body>
                    <div class="page">
                        <div class="top">
                            <div class="crest"><img src="${me}" alt="Logo" /></div>
                            <div class="l1">${t(p)}</div>
                            <div class="l2">${t(y)}</div>
                            <div class="l3">${t(de)}</div>

                            <div class="title">${t(b)}</div>
                            <div class="titleLine">===== ===== =====</div>
                            <div class="subTitle">Generated: ${t(c)}</div>
                        </div>

                        <div class="body">
                            <div class="section">
                                <h2>1. REPORT SUMMARY</h2>
                                <p>${t(ce)}</p>
                                <div class="metaRow">
                                    <div><strong>Total employees:</strong> ${t(X)}</div>
                                    <div><strong>${xe}</strong></div>
                                </div>
                            </div>

                            <div class="section">
                                <h2>2. EMPLOYEE LIST</h2>
                                <p>This table lists all employees included in the current selection.</p>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Full Name</th>
                                            <th>Email</th>
                                            <th>Designation</th>
                                            <th>Phone</th>
                                            <th class="num">Sessions</th>
                                            <th>Last Activity</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${s.join("")}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="footer">
                            <div>Year ${t(new Date().getFullYear())}</div>
                            <div>Employees: <strong>${t(X)}</strong></div>
                        </div>
                    </div>
                </body>
                </html>
            `;W(pe),A(!0)}catch(t){i(t?.message||"Failed to generate PDF preview.")}},ie=()=>{const t=P.current?.contentWindow;t&&(t.focus(),t.print())},re=()=>{if((a.password||"")!==(a.password_confirm||"")){i("Password confirmation does not match.");return}m(!0),i(""),fetch(route("admin.security.employees.store"),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":_(),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({first_name:a.first_name,middle_name:a.middle_name||null,last_name:a.last_name,hire_date:a.hire_date||null,national_id:a.national_id||null,email:a.email,role:a.role,designation:a.designation||null,phone:a.phone||null,sex:a.sex||null,password:a.password})}).then(async t=>{const s=await h(t);if(!t.ok){const c=s?.message||s?.errors?.email?.[0]||s?.errors?.role?.[0]||s?.errors?.password?.[0]||s?.errors?.first_name?.[0]||s?.errors?.last_name?.[0]||"Failed to create employee";throw new Error(c)}j(!1),r({first_name:"",middle_name:"",last_name:"",hire_date:"",national_id:"",email:"",role:"",designation:"",phone:"",sex:"",password:"",password_confirm:""}),v()}).catch(t=>i(t?.message||"Failed to create employee")).finally(()=>m(!1))},S=l.useMemo(()=>{const t=f.trim().toLowerCase();return t?C.filter(s=>{const c=String(s?.full_name||"").toLowerCase(),b=String(s?.user?.email||"").toLowerCase(),p=String(s?.phone||"").toLowerCase(),y=String(s?.designation||"").toLowerCase();return c.includes(t)||b.includes(t)||p.includes(t)||y.includes(t)}):C},[C,f]),oe=l.useMemo(()=>[{key:"users",label:"Users",href:route("admin.user-management.users")},{key:"employees",label:"Employees",href:route("admin.user-management.employees")},{key:"roles",label:"Roles",href:route("admin.user-management.roles")},{key:"permissions",label:"Permissions",href:route("admin.user-management.permissions")},{key:"sessions-logs",label:"Sessions & Logs",href:route("admin.user-management.sessions-logs")}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(fe,{title:"Employees"}),e.jsxs(ge,{title:"User Management",active:"employees",items:oe,children:[e.jsx(ve,{open:U,title:"PDF Preview",onBack:()=>A(!1),onPrint:ie,kind:"html",srcDoc:B,iframeRef:P}),e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Employees"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Employees registered in the system (linked to user accounts)."})]}),e.jsx("div",{className:"text-[12px] text-slate-500",children:o?"Loading…":""})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[e.jsx("input",{value:f,onChange:t=>H(t.target.value),placeholder:"Search by name, email, phone or designation",className:"w-full max-w-md rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] text-slate-900 placeholder:text-slate-400 focus:border-primary-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-primary-500/20"}),e.jsx("button",{type:"button",onClick:()=>j(!0),className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800",children:"Create Employee"}),e.jsx("button",{type:"button",onClick:ne,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Export to PDF"}),e.jsx("button",{type:"button",onClick:v,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Refresh"})]})]}),e.jsxs("div",{className:"p-6",children:[L?e.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-[12px] text-red-700",children:L}):null,J?e.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-slate-950/40 p-4",children:e.jsxs("div",{className:"w-full max-w-lg overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Reset password"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"This will set the user password to a default value."})]}),e.jsx("div",{className:"p-6",children:F?e.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 px-4 py-3 text-[12px] text-emerald-900",children:[e.jsx("div",{className:"font-semibold",children:"Password reset completed"}),e.jsx("div",{className:"mt-1 text-emerald-800",children:"Default password is:"}),e.jsx("div",{className:"mt-2 rounded-lg border border-emerald-200 bg-white px-3 py-2 font-mono text-[12px] text-slate-900",children:"fortco123"}),e.jsx("div",{className:"mt-2 text-[11px] text-emerald-800",children:"You can copy and share it with the user."})]}):e.jsxs("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-4 py-3 text-[12px] text-amber-900",children:[e.jsx("div",{className:"font-semibold",children:"Confirm action"}),e.jsxs("div",{className:"mt-1 text-amber-800",children:["Reset password for ",e.jsx("span",{className:"font-semibold",children:G||"this user"})," to default password ",e.jsx("span",{className:"font-mono font-semibold",children:"fortco123"}),"?"]})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 px-6 py-4",children:[e.jsx("button",{type:"button",onClick:()=>M(!1),disabled:o,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:F?"Close":"Cancel"}),F?null:e.jsx("button",{type:"button",onClick:Z,disabled:o,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:o?"Resetting…":"Confirm reset"})]})]})}):null,Y?e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-slate-950/40 p-4",children:e.jsxs("div",{className:"w-full max-w-2xl overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit Employee"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Update employee details (no password change here)."})]}),e.jsx("button",{type:"button",onClick:()=>N(!1),className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Close"})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"First name"}),e.jsx("input",{value:n.first_name,onChange:t=>d(s=>({...s,first_name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Middle name"}),e.jsx("input",{value:n.middle_name,onChange:t=>d(s=>({...s,middle_name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Last name"}),e.jsx("input",{value:n.last_name,onChange:t=>d(s=>({...s,last_name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Sex"}),e.jsxs("select",{value:n.sex,onChange:t=>d(s=>({...s,sex:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Hire date"}),e.jsx("input",{type:"date",value:n.hire_date,onChange:t=>d(s=>({...s,hire_date:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"National ID"}),e.jsx("input",{value:n.national_id,onChange:t=>d(s=>({...s,national_id:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Email (username)"}),e.jsx("input",{value:n.email,onChange:t=>d(s=>({...s,email:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Role"}),e.jsxs("select",{value:n.role,onChange:t=>d(s=>({...s,role:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select role"}),D.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Designation"}),e.jsx("input",{value:n.designation,onChange:t=>d(s=>({...s,designation:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Mobile number"}),e.jsx("input",{value:n.phone,onChange:t=>d(s=>({...s,phone:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 px-6 py-4",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),disabled:o,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"}),e.jsx("button",{type:"button",onClick:te,disabled:o,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:o?"Saving…":"Save changes"})]})]})}):null,R?e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-slate-950/40 p-4",children:e.jsxs("div",{className:"w-full max-w-2xl overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Create Employee"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Fill employee details. A user account will be created and a reset link will be sent to the email."})]}),e.jsx("button",{type:"button",onClick:()=>j(!1),className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50",children:"Close"})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:w===1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"First name"}),e.jsx("input",{value:a.first_name,onChange:t=>r(s=>({...s,first_name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"John"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Middle name"}),e.jsx("input",{value:a.middle_name,onChange:t=>r(s=>({...s,middle_name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"(optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Last name"}),e.jsx("input",{value:a.last_name,onChange:t=>r(s=>({...s,last_name:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Sex"}),e.jsxs("select",{value:a.sex,onChange:t=>r(s=>({...s,sex:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Hire date"}),e.jsx("input",{type:"date",value:a.hire_date,onChange:t=>r(s=>({...s,hire_date:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"National ID"}),e.jsx("input",{value:a.national_id,onChange:t=>r(s=>({...s,national_id:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"NIDA / Passport"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Email (will be username)"}),e.jsx("input",{value:a.email,onChange:t=>r(s=>({...s,email:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"john@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Role"}),e.jsxs("select",{value:a.role,onChange:t=>r(s=>({...s,role:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",children:[e.jsx("option",{value:"",children:"Select role"}),D.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Designation"}),e.jsx("input",{value:a.designation,onChange:t=>r(s=>({...s,designation:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Accountant"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Mobile number"}),e.jsx("input",{value:a.phone,onChange:t=>r(s=>({...s,phone:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"+255..."})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-[12px] text-slate-700",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:"Account details"}),e.jsx("div",{className:"mt-1 text-slate-600",children:"Username will be the email you entered."})]})}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Username"}),e.jsx("input",{value:a.email,readOnly:!0,className:"mt-1 w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[12px] text-slate-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Password"}),e.jsx("input",{type:"password",value:a.password,onChange:t=>r(s=>({...s,password:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Minimum 8 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Confirm password"}),e.jsx("input",{type:"password",value:a.password_confirm,onChange:t=>r(s=>({...s,password_confirm:t.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]"})]})]})})}),e.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 px-6 py-4",children:[w===2?e.jsx("button",{type:"button",onClick:()=>k(1),disabled:o,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:"Back"}):null,e.jsx("button",{type:"button",onClick:()=>j(!1),disabled:o,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-60",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>{if(w===1){if(!a.first_name.trim()||!a.last_name.trim()||!a.email.trim()||!a.role.trim()){i("Please fill required fields (first name, last name, email, role).");return}i(""),k(2);return}re()},disabled:o,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:w===1?"Next":o?"Saving…":"Create Employee"})]})]})}):null,e.jsxs("table",{className:"w-full border border-slate-200 text-left text-[12px]",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Full Name"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Email"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"National ID"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Hire Date"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Sex"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Department"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Designation"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Sessions"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Last Activity"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:S.length?S.map(t=>e.jsxs("tr",{className:"bg-white hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 font-semibold text-slate-900",children:t.full_name}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.user?.email||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.national_id||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.hire_date?new Date(t.hire_date).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.sex||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.department||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.designation||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.phone||"-"}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.sessions_count??0}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:t.last_activity?new Date(t.last_activity).toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-slate-700",children:t.user?.banned_at?"Banned":t.active?"Active":"Inactive"})}),e.jsx("td",{className:"relative px-4 py-3 text-right",children:e.jsxs("div",{className:"inline-block",ref:g&&String(g)===String(t.id)?E:null,children:[e.jsx("button",{type:"button",onClick:()=>u(s=>String(s)===String(t.id)?"":String(t.id)),className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-200 bg-white text-slate-600 hover:bg-slate-50","aria-label":"Actions",children:e.jsx("span",{className:"text-lg leading-none",children:"⋯"})}),String(g)===String(t.id)?e.jsxs("div",{className:"absolute right-0 z-20 mt-2 w-44 overflow-hidden rounded-xl border border-slate-200 bg-white shadow-lg",children:[e.jsx("button",{type:"button",onClick:()=>{u(""),ee(t)},className:"block w-full px-4 py-2 text-left text-[12px] text-slate-700 hover:bg-slate-50",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>{u(""),ae(t)},className:"block w-full px-4 py-2 text-left text-[12px] text-slate-700 hover:bg-slate-50",children:"View profile"}),e.jsx("button",{type:"button",onClick:()=>{u(""),le(t)},className:"block w-full px-4 py-2 text-left text-[12px] text-slate-700 hover:bg-slate-50",children:t.user?.banned_at?"Unban":"Ban"}),e.jsx("button",{type:"button",onClick:()=>{u(""),V(t)},className:"block w-full px-4 py-2 text-left text-[12px] text-slate-700 hover:bg-slate-50",children:"Reset password"})]}):null]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{className:"px-4 py-6 text-slate-500",colSpan:12,children:"No employees found."})})})]})]})]})]})]})}export{Ee as default};
