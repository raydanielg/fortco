import{r,j as e,H as A}from"./app-_tcWvRHw.js";import{C as X}from"./ConstructionPanelLayout-smiwN9nJ.js";import"./DashboardLayout-Dotb40vo.js";import"./AnimatedIcon-D_as9RWF.js";import"./index-D3vds0s7.js";import"./index-DoyJDsUh.js";function M(){const[c,x]=r.useState("all"),[l,o]=r.useState(!1),[g,a]=r.useState(""),[n,w]=r.useState([]),[m,f]=r.useState(""),[C,y]=r.useState(!1),[j,N]=r.useState(""),[p,b]=r.useState(""),h=()=>document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",d=async t=>{const s=await t.text();try{return s?JSON.parse(s):{}}catch{return{}}},k=r.useMemo(()=>[{key:"projects",label:"Projects",href:route("admin.construction.projects")},{key:"create",label:"Create Projects",href:route("admin.construction.projects.create")},{key:"categories",label:"Project Categories",href:route("admin.construction.project-categories")},{key:"locations",label:"Locations",href:route("admin.construction.locations")},{key:"materials",label:"Materials",href:route("admin.construction.materials")},{key:"workers",label:"Workers",href:route("admin.construction.workers")}],[]),i=()=>{o(!0),a(""),fetch(route("admin.construction.project-categories.data"),{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(async t=>{const s=await d(t);if(!t.ok)throw new Error(s?.message||"Failed to load categories");w(Array.isArray(s?.categories)?s.categories:[])}).catch(t=>a(t?.message||"Failed to load categories")).finally(()=>o(!1))};r.useEffect(()=>{i()},[]);const S=()=>{if(!m.trim()){a("Category name is required");return}o(!0),a(""),fetch(route("admin.construction.project-categories.store"),{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"},body:JSON.stringify({name:m.trim()})}).then(async t=>{const s=await d(t);if(!t.ok)throw new Error(s?.message||"Failed to create category");f(""),x("all"),i()}).catch(t=>a(t?.message||"Failed to create category")).finally(()=>o(!1))},E=t=>{t?.id&&window.confirm(`Delete category "${t.name}"?`)&&(o(!0),a(""),fetch(route("admin.construction.project-categories.destroy",{category:t.id}),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"}}).then(async s=>{const v=await d(s);if(!s.ok)throw new Error(v?.message||"Delete failed");i()}).catch(s=>a(s?.message||"Delete failed")).finally(()=>o(!1)))},R=t=>{a(""),N(String(t?.id||"")),b(String(t?.name||"")),y(!0)},u=()=>{y(!1),N(""),b("")},q=()=>{if(j){if(!p.trim()){a("Category name is required");return}o(!0),a(""),fetch(route("admin.construction.project-categories.update",{category:j}),{method:"PUT",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":h(),Accept:"application/json"},body:JSON.stringify({name:p.trim()})}).then(async t=>{const s=await d(t);if(!t.ok)throw new Error(s?.message||"Update failed");u(),i()}).catch(t=>a(t?.message||"Update failed")).finally(()=>o(!1))}};return e.jsxs(X,{title:"Construction",active:"categories",items:k,children:[e.jsx(A,{title:"Project Categories"}),e.jsxs("div",{className:"border-b border-slate-200 px-6 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Project Categories"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-500",children:"Create and manage categories used in Construction projects."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>x("all"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(c==="all"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"All items"}),e.jsx("button",{type:"button",onClick:()=>x("create"),className:"rounded-xl px-4 py-2 text-[12px] font-semibold transition "+(c==="create"?"bg-slate-900 text-white":"border border-slate-200 bg-white text-slate-900 hover:bg-slate-50"),children:"Create"})]})]}),e.jsxs("div",{className:"p-6",children:[g?e.jsx("div",{className:"mb-4 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-[12px] text-rose-700",children:g}):null,c==="create"?e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Create category"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Add a category to classify projects."}),e.jsxs("div",{className:"mt-5 grid gap-3 sm:grid-cols-3",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Name"}),e.jsx("input",{value:m,onChange:t=>f(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"e.g. Luxury Residential"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",onClick:S,disabled:l,className:"w-full rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white shadow-sm hover:bg-slate-800 disabled:opacity-60",children:"Save"})})]})]}):e.jsxs("div",{className:"overflow-hidden rounded-2xl border border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-slate-200 bg-slate-50 px-4 py-3",children:[e.jsx("div",{className:"text-[12px] font-semibold text-slate-900",children:"All categories"}),e.jsx("button",{type:"button",onClick:i,disabled:l,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Name"}),e.jsx("th",{className:"w-24 px-4 py-3 text-right text-[11px] font-semibold uppercase tracking-wide text-slate-600",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 bg-white",children:[l&&!n.length?e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"Loading..."})}):null,!l&&!n.length?e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-10 text-center text-[12px] text-slate-500",children:"No categories found."})}):null,n.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-[12px] font-semibold text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>R(t),disabled:l,className:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50 disabled:opacity-60",children:"Edit"}),e.jsx("button",{type:"button",onClick:()=>E(t),disabled:l,className:"rounded-xl border border-rose-200 bg-rose-50 px-3 py-2 text-[12px] font-semibold text-rose-700 hover:bg-rose-100 disabled:opacity-60",children:"Delete"})]})})]},t.id))]})]})}),e.jsxs("div",{className:"border-t border-slate-200 px-4 py-3 text-[11px] text-slate-500",children:["Showing ",n.length," item(s)"]})]}),C?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("button",{type:"button",className:"absolute inset-0 bg-slate-900/40",onClick:u,"aria-label":"Close"}),e.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-xl",children:[e.jsxs("div",{className:"border-b border-slate-200 px-5 py-4",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Edit category"}),e.jsx("div",{className:"mt-1 text-[12px] text-slate-600",children:"Update the category name and save changes."})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("label",{className:"text-[11px] font-semibold text-slate-700",children:"Name"}),e.jsx("input",{value:p,onChange:t=>b(t.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-[12px]",placeholder:"Category name"}),e.jsxs("div",{className:"mt-5 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:u,className:"rounded-xl border border-slate-200 bg-white px-4 py-2 text-[12px] font-semibold text-slate-900 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:q,disabled:l,className:"rounded-xl bg-slate-900 px-4 py-2 text-[12px] font-semibold text-white hover:bg-slate-800 disabled:opacity-60",children:"Save"})]})]})]})]}):null]})]})}export{M as default};
